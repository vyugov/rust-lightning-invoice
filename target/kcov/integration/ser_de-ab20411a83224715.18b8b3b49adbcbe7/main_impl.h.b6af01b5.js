var data = {lines:[
{"lineNum":"    1","line":"/**********************************************************************"},
{"lineNum":"    2","line":" * Copyright (c) 2013-2015 Pieter Wuille                              *"},
{"lineNum":"    3","line":" * Distributed under the MIT software license, see the accompanying   *"},
{"lineNum":"    4","line":" * file COPYING or http://www.opensource.org/licenses/mit-license.php.*"},
{"lineNum":"    5","line":" **********************************************************************/"},
{"lineNum":"    6","line":""},
{"lineNum":"    7","line":"#ifndef SECP256K1_MODULE_RECOVERY_MAIN_H"},
{"lineNum":"    8","line":"#define SECP256K1_MODULE_RECOVERY_MAIN_H"},
{"lineNum":"    9","line":""},
{"lineNum":"   10","line":"#include \"include/secp256k1_recovery.h\""},
{"lineNum":"   11","line":""},
{"lineNum":"   12","line":"static void secp256k1_ecdsa_recoverable_signature_load(const secp256k1_context* ctx, secp256k1_scalar* r, secp256k1_scalar* s, int* recid, const secp256k1_ecdsa_recoverable_signature* sig) {","class":"lineCov","hits":"1","order":"2890","possible_hits":"1",},
{"lineNum":"   13","line":"    (void)ctx;"},
{"lineNum":"   14","line":"    if (sizeof(secp256k1_scalar) == 32) {"},
{"lineNum":"   15","line":"        /* When the secp256k1_scalar type is exactly 32 byte, use its"},
{"lineNum":"   16","line":"         * representation inside secp256k1_ecdsa_signature, as conversion is very fast."},
{"lineNum":"   17","line":"         * Note that secp256k1_ecdsa_signature_save must use the same representation. */"},
{"lineNum":"   18","line":"        memcpy(r, &sig->data[0], 32);","class":"lineCov","hits":"1","order":"2891","possible_hits":"1",},
{"lineNum":"   19","line":"        memcpy(s, &sig->data[32], 32);","class":"lineCov","hits":"1","order":"2892","possible_hits":"1",},
{"lineNum":"   20","line":"    } else {"},
{"lineNum":"   21","line":"        secp256k1_scalar_set_b32(r, &sig->data[0], NULL);"},
{"lineNum":"   22","line":"        secp256k1_scalar_set_b32(s, &sig->data[32], NULL);"},
{"lineNum":"   23","line":"    }"},
{"lineNum":"   24","line":"    *recid = sig->data[64];","class":"lineCov","hits":"1","order":"2893","possible_hits":"1",},
{"lineNum":"   25","line":"}","class":"linePartCov","hits":"1","order":"2894","possible_hits":"2",},
{"lineNum":"   26","line":""},
{"lineNum":"   27","line":"static void secp256k1_ecdsa_recoverable_signature_save(secp256k1_ecdsa_recoverable_signature* sig, const secp256k1_scalar* r, const secp256k1_scalar* s, int recid) {","class":"lineCov","hits":"1","order":"2678","possible_hits":"1",},
{"lineNum":"   28","line":"    if (sizeof(secp256k1_scalar) == 32) {"},
{"lineNum":"   29","line":"        memcpy(&sig->data[0], r, 32);","class":"lineCov","hits":"1","order":"2679","possible_hits":"1",},
{"lineNum":"   30","line":"        memcpy(&sig->data[32], s, 32);","class":"lineCov","hits":"1","order":"2680","possible_hits":"1",},
{"lineNum":"   31","line":"    } else {"},
{"lineNum":"   32","line":"        secp256k1_scalar_get_b32(&sig->data[0], r);"},
{"lineNum":"   33","line":"        secp256k1_scalar_get_b32(&sig->data[32], s);"},
{"lineNum":"   34","line":"    }"},
{"lineNum":"   35","line":"    sig->data[64] = recid;","class":"lineCov","hits":"1","order":"2681","possible_hits":"1",},
{"lineNum":"   36","line":"}","class":"linePartCov","hits":"1","order":"2682","possible_hits":"2",},
{"lineNum":"   37","line":""},
{"lineNum":"   38","line":"int secp256k1_ecdsa_recoverable_signature_parse_compact(const secp256k1_context* ctx, secp256k1_ecdsa_recoverable_signature* sig, const unsigned char *input64, int recid) {","class":"lineCov","hits":"1","order":"2635","possible_hits":"1",},
{"lineNum":"   39","line":"    secp256k1_scalar r, s;"},
{"lineNum":"   40","line":"    int ret = 1;","class":"lineCov","hits":"1","order":"2636","possible_hits":"1",},
{"lineNum":"   41","line":"    int overflow = 0;","class":"lineCov","hits":"1","order":"2637","possible_hits":"1",},
{"lineNum":"   42","line":""},
{"lineNum":"   43","line":"    (void)ctx;"},
{"lineNum":"   44","line":"    ARG_CHECK(sig != NULL);","class":"lineCov","hits":"1","order":"2638","possible_hits":"1",},
{"lineNum":"   45","line":"    ARG_CHECK(input64 != NULL);","class":"lineCov","hits":"1","order":"2639","possible_hits":"1",},
{"lineNum":"   46","line":"    ARG_CHECK(recid >= 0 && recid <= 3);","class":"lineCov","hits":"1","order":"2640","possible_hits":"1",},
{"lineNum":"   47","line":""},
{"lineNum":"   48","line":"    secp256k1_scalar_set_b32(&r, &input64[0], &overflow);","class":"lineCov","hits":"1","order":"2641","possible_hits":"1",},
{"lineNum":"   49","line":"    ret &= !overflow;","class":"lineCov","hits":"1","order":"2673","possible_hits":"1",},
{"lineNum":"   50","line":"    secp256k1_scalar_set_b32(&s, &input64[32], &overflow);","class":"lineCov","hits":"1","order":"2674","possible_hits":"1",},
{"lineNum":"   51","line":"    ret &= !overflow;","class":"lineCov","hits":"1","order":"2675","possible_hits":"1",},
{"lineNum":"   52","line":"    if (ret) {","class":"lineCov","hits":"1","order":"2676","possible_hits":"1",},
{"lineNum":"   53","line":"        secp256k1_ecdsa_recoverable_signature_save(sig, &r, &s, recid);","class":"lineCov","hits":"1","order":"2677","possible_hits":"1",},
{"lineNum":"   54","line":"    } else {"},
{"lineNum":"   55","line":"        memset(sig, 0, sizeof(*sig));","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"   56","line":"    }"},
{"lineNum":"   57","line":"    return ret;","class":"lineCov","hits":"1","order":"2683","possible_hits":"1",},
{"lineNum":"   58","line":"}","class":"linePartCov","hits":"1","order":"2684","possible_hits":"2",},
{"lineNum":"   59","line":""},
{"lineNum":"   60","line":"int secp256k1_ecdsa_recoverable_signature_serialize_compact(const secp256k1_context* ctx, unsigned char *output64, int *recid, const secp256k1_ecdsa_recoverable_signature* sig) {","class":"lineCov","hits":"1","order":"2885","possible_hits":"1",},
{"lineNum":"   61","line":"    secp256k1_scalar r, s;"},
{"lineNum":"   62","line":""},
{"lineNum":"   63","line":"    (void)ctx;"},
{"lineNum":"   64","line":"    ARG_CHECK(output64 != NULL);","class":"lineCov","hits":"1","order":"2886","possible_hits":"1",},
{"lineNum":"   65","line":"    ARG_CHECK(sig != NULL);","class":"lineCov","hits":"1","order":"2887","possible_hits":"1",},
{"lineNum":"   66","line":"    ARG_CHECK(recid != NULL);","class":"lineCov","hits":"1","order":"2888","possible_hits":"1",},
{"lineNum":"   67","line":""},
{"lineNum":"   68","line":"    secp256k1_ecdsa_recoverable_signature_load(ctx, &r, &s, recid, sig);","class":"lineCov","hits":"1","order":"2889","possible_hits":"1",},
{"lineNum":"   69","line":"    secp256k1_scalar_get_b32(&output64[0], &r);","class":"lineCov","hits":"1","order":"2895","possible_hits":"1",},
{"lineNum":"   70","line":"    secp256k1_scalar_get_b32(&output64[32], &s);","class":"lineCov","hits":"1","order":"2902","possible_hits":"1",},
{"lineNum":"   71","line":"    return 1;","class":"lineCov","hits":"1","order":"2903","possible_hits":"1",},
{"lineNum":"   72","line":"}","class":"linePartCov","hits":"1","order":"2904","possible_hits":"2",},
{"lineNum":"   73","line":""},
{"lineNum":"   74","line":"int secp256k1_ecdsa_recoverable_signature_convert(const secp256k1_context* ctx, secp256k1_ecdsa_signature* sig, const secp256k1_ecdsa_recoverable_signature* sigin) {","class":"lineCov","hits":"1","order":"5286","possible_hits":"1",},
{"lineNum":"   75","line":"    secp256k1_scalar r, s;"},
{"lineNum":"   76","line":"    int recid;"},
{"lineNum":"   77","line":""},
{"lineNum":"   78","line":"    (void)ctx;"},
{"lineNum":"   79","line":"    ARG_CHECK(sig != NULL);","class":"lineCov","hits":"1","order":"5287","possible_hits":"1",},
{"lineNum":"   80","line":"    ARG_CHECK(sigin != NULL);","class":"lineCov","hits":"1","order":"5288","possible_hits":"1",},
{"lineNum":"   81","line":""},
{"lineNum":"   82","line":"    secp256k1_ecdsa_recoverable_signature_load(ctx, &r, &s, &recid, sigin);","class":"lineCov","hits":"1","order":"5289","possible_hits":"1",},
{"lineNum":"   83","line":"    secp256k1_ecdsa_signature_save(sig, &r, &s);","class":"lineCov","hits":"1","order":"5290","possible_hits":"1",},
{"lineNum":"   84","line":"    return 1;","class":"lineCov","hits":"1","order":"5295","possible_hits":"1",},
{"lineNum":"   85","line":"}","class":"linePartCov","hits":"1","order":"5296","possible_hits":"2",},
{"lineNum":"   86","line":""},
{"lineNum":"   87","line":"static int secp256k1_ecdsa_sig_recover(const secp256k1_ecmult_context *ctx, const secp256k1_scalar *sigr, const secp256k1_scalar* sigs, secp256k1_ge *pubkey, const secp256k1_scalar *message, int recid) {","class":"lineCov","hits":"2","order":"4770","possible_hits":"2",},
{"lineNum":"   88","line":"    unsigned char brx[32];"},
{"lineNum":"   89","line":"    secp256k1_fe fx;"},
{"lineNum":"   90","line":"    secp256k1_ge x;"},
{"lineNum":"   91","line":"    secp256k1_gej xj;"},
{"lineNum":"   92","line":"    secp256k1_scalar rn, u1, u2;"},
{"lineNum":"   93","line":"    secp256k1_gej qj;"},
{"lineNum":"   94","line":"    int r;"},
{"lineNum":"   95","line":""},
{"lineNum":"   96","line":"    if (secp256k1_scalar_is_zero(sigr) || secp256k1_scalar_is_zero(sigs)) {","class":"lineCov","hits":"1","order":"4771","possible_hits":"1",},
{"lineNum":"   97","line":"        return 0;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"   98","line":"    }"},
{"lineNum":"   99","line":""},
{"lineNum":"  100","line":"    secp256k1_scalar_get_b32(brx, sigr);","class":"lineCov","hits":"1","order":"4772","possible_hits":"1",},
{"lineNum":"  101","line":"    r = secp256k1_fe_set_b32(&fx, brx);","class":"lineCov","hits":"1","order":"4773","possible_hits":"1",},
{"lineNum":"  102","line":"    (void)r;"},
{"lineNum":"  103","line":"    VERIFY_CHECK(r); /* brx comes from a scalar, so is less than the order; certainly less than p */"},
{"lineNum":"  104","line":"    if (recid & 2) {","class":"lineCov","hits":"1","order":"4774","possible_hits":"1",},
{"lineNum":"  105","line":"        if (secp256k1_fe_cmp_var(&fx, &secp256k1_ecdsa_const_p_minus_order) >= 0) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  106","line":"            return 0;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  107","line":"        }"},
{"lineNum":"  108","line":"        secp256k1_fe_add(&fx, &secp256k1_ecdsa_const_order_as_fe);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  109","line":"    }"},
{"lineNum":"  110","line":"    if (!secp256k1_ge_set_xo_var(&x, &fx, recid & 1)) {","class":"lineCov","hits":"1","order":"4775","possible_hits":"1",},
{"lineNum":"  111","line":"        return 0;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  112","line":"    }"},
{"lineNum":"  113","line":"    secp256k1_gej_set_ge(&xj, &x);","class":"lineCov","hits":"1","order":"4777","possible_hits":"1",},
{"lineNum":"  114","line":"    secp256k1_scalar_inverse_var(&rn, sigr);","class":"lineCov","hits":"1","order":"4778","possible_hits":"1",},
{"lineNum":"  115","line":"    secp256k1_scalar_mul(&u1, &rn, message);","class":"lineCov","hits":"1","order":"5000","possible_hits":"1",},
{"lineNum":"  116","line":"    secp256k1_scalar_negate(&u1, &u1);","class":"lineCov","hits":"1","order":"5001","possible_hits":"1",},
{"lineNum":"  117","line":"    secp256k1_scalar_mul(&u2, &rn, sigs);","class":"lineCov","hits":"1","order":"5002","possible_hits":"1",},
{"lineNum":"  118","line":"    secp256k1_ecmult(ctx, &qj, &xj, &u2, &u1);","class":"lineCov","hits":"1","order":"5003","possible_hits":"1",},
{"lineNum":"  119","line":"    secp256k1_ge_set_gej_var(pubkey, &qj);","class":"lineCov","hits":"1","order":"5191","possible_hits":"1",},
{"lineNum":"  120","line":"    return !secp256k1_gej_is_infinity(&qj);","class":"lineCov","hits":"1","order":"5204","possible_hits":"1",},
{"lineNum":"  121","line":"}","class":"linePartCov","hits":"1","order":"5205","possible_hits":"2",},
{"lineNum":"  122","line":""},
{"lineNum":"  123","line":"int secp256k1_ecdsa_sign_recoverable(const secp256k1_context* ctx, secp256k1_ecdsa_recoverable_signature *signature, const unsigned char *msg32, const unsigned char *seckey, secp256k1_nonce_function noncefp, const void* noncedata) {"},
{"lineNum":"  124","line":"    secp256k1_scalar r, s;"},
{"lineNum":"  125","line":"    secp256k1_scalar sec, non, msg;"},
{"lineNum":"  126","line":"    int recid;"},
{"lineNum":"  127","line":"    int ret = 0;"},
{"lineNum":"  128","line":"    int overflow = 0;"},
{"lineNum":"  129","line":"    VERIFY_CHECK(ctx != NULL);"},
{"lineNum":"  130","line":"    ARG_CHECK(secp256k1_ecmult_gen_context_is_built(&ctx->ecmult_gen_ctx));"},
{"lineNum":"  131","line":"    ARG_CHECK(msg32 != NULL);"},
{"lineNum":"  132","line":"    ARG_CHECK(signature != NULL);"},
{"lineNum":"  133","line":"    ARG_CHECK(seckey != NULL);"},
{"lineNum":"  134","line":"    if (noncefp == NULL) {"},
{"lineNum":"  135","line":"        noncefp = secp256k1_nonce_function_default;"},
{"lineNum":"  136","line":"    }"},
{"lineNum":"  137","line":""},
{"lineNum":"  138","line":"    secp256k1_scalar_set_b32(&sec, seckey, &overflow);"},
{"lineNum":"  139","line":"    /* Fail if the secret key is invalid. */"},
{"lineNum":"  140","line":"    if (!overflow && !secp256k1_scalar_is_zero(&sec)) {"},
{"lineNum":"  141","line":"        unsigned char nonce32[32];"},
{"lineNum":"  142","line":"        unsigned int count = 0;"},
{"lineNum":"  143","line":"        secp256k1_scalar_set_b32(&msg, msg32, NULL);"},
{"lineNum":"  144","line":"        while (1) {"},
{"lineNum":"  145","line":"            ret = noncefp(nonce32, msg32, seckey, NULL, (void*)noncedata, count);"},
{"lineNum":"  146","line":"            if (!ret) {"},
{"lineNum":"  147","line":"                break;"},
{"lineNum":"  148","line":"            }"},
{"lineNum":"  149","line":"            secp256k1_scalar_set_b32(&non, nonce32, &overflow);"},
{"lineNum":"  150","line":"            if (!secp256k1_scalar_is_zero(&non) && !overflow) {"},
{"lineNum":"  151","line":"                if (secp256k1_ecdsa_sig_sign(&ctx->ecmult_gen_ctx, &r, &s, &sec, &msg, &non, &recid)) {"},
{"lineNum":"  152","line":"                    break;"},
{"lineNum":"  153","line":"                }"},
{"lineNum":"  154","line":"            }"},
{"lineNum":"  155","line":"            count++;"},
{"lineNum":"  156","line":"        }"},
{"lineNum":"  157","line":"        memset(nonce32, 0, 32);"},
{"lineNum":"  158","line":"        secp256k1_scalar_clear(&msg);"},
{"lineNum":"  159","line":"        secp256k1_scalar_clear(&non);"},
{"lineNum":"  160","line":"        secp256k1_scalar_clear(&sec);"},
{"lineNum":"  161","line":"    }"},
{"lineNum":"  162","line":"    if (ret) {"},
{"lineNum":"  163","line":"        secp256k1_ecdsa_recoverable_signature_save(signature, &r, &s, recid);"},
{"lineNum":"  164","line":"    } else {"},
{"lineNum":"  165","line":"        memset(signature, 0, sizeof(*signature));"},
{"lineNum":"  166","line":"    }"},
{"lineNum":"  167","line":"    return ret;"},
{"lineNum":"  168","line":"}"},
{"lineNum":"  169","line":""},
{"lineNum":"  170","line":"int secp256k1_ecdsa_recover(const secp256k1_context* ctx, secp256k1_pubkey *pubkey, const secp256k1_ecdsa_recoverable_signature *signature, const unsigned char *msg32) {","class":"lineCov","hits":"1","order":"4758","possible_hits":"1",},
{"lineNum":"  171","line":"    secp256k1_ge q;"},
{"lineNum":"  172","line":"    secp256k1_scalar r, s;"},
{"lineNum":"  173","line":"    secp256k1_scalar m;"},
{"lineNum":"  174","line":"    int recid;"},
{"lineNum":"  175","line":"    VERIFY_CHECK(ctx != NULL);"},
{"lineNum":"  176","line":"    ARG_CHECK(secp256k1_ecmult_context_is_built(&ctx->ecmult_ctx));","class":"lineCov","hits":"1","order":"4759","possible_hits":"1",},
{"lineNum":"  177","line":"    ARG_CHECK(msg32 != NULL);","class":"lineCov","hits":"1","order":"4763","possible_hits":"1",},
{"lineNum":"  178","line":"    ARG_CHECK(signature != NULL);","class":"lineCov","hits":"1","order":"4764","possible_hits":"1",},
{"lineNum":"  179","line":"    ARG_CHECK(pubkey != NULL);","class":"lineCov","hits":"1","order":"4765","possible_hits":"1",},
{"lineNum":"  180","line":""},
{"lineNum":"  181","line":"    secp256k1_ecdsa_recoverable_signature_load(ctx, &r, &s, &recid, signature);","class":"lineCov","hits":"1","order":"4766","possible_hits":"1",},
{"lineNum":"  182","line":"    VERIFY_CHECK(recid >= 0 && recid < 4);  /* should have been caught in parse_compact */","class":"lineCov","hits":"1","order":"4767","possible_hits":"1",},
{"lineNum":"  183","line":"    secp256k1_scalar_set_b32(&m, msg32, NULL);","class":"lineCov","hits":"1","order":"4768","possible_hits":"1",},
{"lineNum":"  184","line":"    if (secp256k1_ecdsa_sig_recover(&ctx->ecmult_ctx, &r, &s, &q, &m, recid)) {","class":"lineCov","hits":"1","order":"4769","possible_hits":"1",},
{"lineNum":"  185","line":"        secp256k1_pubkey_save(pubkey, &q);","class":"lineCov","hits":"1","order":"5206","possible_hits":"1",},
{"lineNum":"  186","line":"        return 1;","class":"lineCov","hits":"1","order":"5211","possible_hits":"1",},
{"lineNum":"  187","line":"    } else {"},
{"lineNum":"  188","line":"        memset(pubkey, 0, sizeof(*pubkey));","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  189","line":"        return 0;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  190","line":"    }"},
{"lineNum":"  191","line":"}","class":"linePartCov","hits":"1","order":"5212","possible_hits":"2",},
{"lineNum":"  192","line":""},
{"lineNum":"  193","line":"#endif /* SECP256K1_MODULE_RECOVERY_MAIN_H */"},
]};
var percent_low = 25;var percent_high = 75;
var header = { "command" : "ser_de-ab20411a83224715", "date" : "2019-06-01 07:50:29", "instrumented" : 75, "covered" : 67,};
var merged_data = [];
