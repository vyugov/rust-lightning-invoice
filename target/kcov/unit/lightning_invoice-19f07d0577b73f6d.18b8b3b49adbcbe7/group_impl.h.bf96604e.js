var data = {lines:[
{"lineNum":"    1","line":"/**********************************************************************"},
{"lineNum":"    2","line":" * Copyright (c) 2013, 2014 Pieter Wuille                             *"},
{"lineNum":"    3","line":" * Distributed under the MIT software license, see the accompanying   *"},
{"lineNum":"    4","line":" * file COPYING or http://www.opensource.org/licenses/mit-license.php.*"},
{"lineNum":"    5","line":" **********************************************************************/"},
{"lineNum":"    6","line":""},
{"lineNum":"    7","line":"#ifndef SECP256K1_GROUP_IMPL_H"},
{"lineNum":"    8","line":"#define SECP256K1_GROUP_IMPL_H"},
{"lineNum":"    9","line":""},
{"lineNum":"   10","line":"#include \"num.h\""},
{"lineNum":"   11","line":"#include \"field.h\""},
{"lineNum":"   12","line":"#include \"group.h\""},
{"lineNum":"   13","line":""},
{"lineNum":"   14","line":"/* These points can be generated in sage as follows:"},
{"lineNum":"   15","line":" *"},
{"lineNum":"   16","line":" * 0. Setup a worksheet with the following parameters."},
{"lineNum":"   17","line":" *   b = 4  # whatever CURVE_B will be set to"},
{"lineNum":"   18","line":" *   F = FiniteField (0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F)"},
{"lineNum":"   19","line":" *   C = EllipticCurve ([F (0), F (b)])"},
{"lineNum":"   20","line":" *"},
{"lineNum":"   21","line":" * 1. Determine all the small orders available to you. (If there are"},
{"lineNum":"   22","line":" *    no satisfactory ones, go back and change b.)"},
{"lineNum":"   23","line":" *   print C.order().factor(limit=1000)"},
{"lineNum":"   24","line":" *"},
{"lineNum":"   25","line":" * 2. Choose an order as one of the prime factors listed in the above step."},
{"lineNum":"   26","line":" *    (You can also multiply some to get a composite order, though the"},
{"lineNum":"   27","line":" *    tests will crash trying to invert scalars during signing.) We take a"},
{"lineNum":"   28","line":" *    random point and scale it to drop its order to the desired value."},
{"lineNum":"   29","line":" *    There is some probability this won\'t work; just try again."},
{"lineNum":"   30","line":" *   order = 199"},
{"lineNum":"   31","line":" *   P = C.random_point()"},
{"lineNum":"   32","line":" *   P = (int(P.order()) / int(order)) * P"},
{"lineNum":"   33","line":" *   assert(P.order() == order)"},
{"lineNum":"   34","line":" *"},
{"lineNum":"   35","line":" * 3. Print the values. You\'ll need to use a vim macro or something to"},
{"lineNum":"   36","line":" *    split the hex output into 4-byte chunks."},
{"lineNum":"   37","line":" *   print \"%x %x\" % P.xy()"},
{"lineNum":"   38","line":" */"},
{"lineNum":"   39","line":"#if defined(EXHAUSTIVE_TEST_ORDER)"},
{"lineNum":"   40","line":"#  if EXHAUSTIVE_TEST_ORDER == 199"},
{"lineNum":"   41","line":"const secp256k1_ge secp256k1_ge_const_g = SECP256K1_GE_CONST("},
{"lineNum":"   42","line":"    0xFA7CC9A7, 0x0737F2DB, 0xA749DD39, 0x2B4FB069,"},
{"lineNum":"   43","line":"    0x3B017A7D, 0xA808C2F1, 0xFB12940C, 0x9EA66C18,"},
{"lineNum":"   44","line":"    0x78AC123A, 0x5ED8AEF3, 0x8732BC91, 0x1F3A2868,"},
{"lineNum":"   45","line":"    0x48DF246C, 0x808DAE72, 0xCFE52572, 0x7F0501ED"},
{"lineNum":"   46","line":");"},
{"lineNum":"   47","line":""},
{"lineNum":"   48","line":"const int CURVE_B = 4;"},
{"lineNum":"   49","line":"#  elif EXHAUSTIVE_TEST_ORDER == 13"},
{"lineNum":"   50","line":"const secp256k1_ge secp256k1_ge_const_g = SECP256K1_GE_CONST("},
{"lineNum":"   51","line":"    0xedc60018, 0xa51a786b, 0x2ea91f4d, 0x4c9416c0,"},
{"lineNum":"   52","line":"    0x9de54c3b, 0xa1316554, 0x6cf4345c, 0x7277ef15,"},
{"lineNum":"   53","line":"    0x54cb1b6b, 0xdc8c1273, 0x087844ea, 0x43f4603e,"},
{"lineNum":"   54","line":"    0x0eaf9a43, 0xf6effe55, 0x939f806d, 0x37adf8ac"},
{"lineNum":"   55","line":");"},
{"lineNum":"   56","line":"const int CURVE_B = 2;"},
{"lineNum":"   57","line":"#  else"},
{"lineNum":"   58","line":"#    error No known generator for the specified exhaustive test group order."},
{"lineNum":"   59","line":"#  endif"},
{"lineNum":"   60","line":"#else"},
{"lineNum":"   61","line":"/** Generator for secp256k1, value \'g\' defined in"},
{"lineNum":"   62","line":" *  \"Standards for Efficient Cryptography\" (SEC2) 2.7.1."},
{"lineNum":"   63","line":" */"},
{"lineNum":"   64","line":"static const secp256k1_ge secp256k1_ge_const_g = SECP256K1_GE_CONST("},
{"lineNum":"   65","line":"    0x79BE667EUL, 0xF9DCBBACUL, 0x55A06295UL, 0xCE870B07UL,"},
{"lineNum":"   66","line":"    0x029BFCDBUL, 0x2DCE28D9UL, 0x59F2815BUL, 0x16F81798UL,"},
{"lineNum":"   67","line":"    0x483ADA77UL, 0x26A3C465UL, 0x5DA4FBFCUL, 0x0E1108A8UL,"},
{"lineNum":"   68","line":"    0xFD17B448UL, 0xA6855419UL, 0x9C47D08FUL, 0xFB10D4B8UL"},
{"lineNum":"   69","line":");"},
{"lineNum":"   70","line":""},
{"lineNum":"   71","line":"const int CURVE_B = 7;"},
{"lineNum":"   72","line":"#endif"},
{"lineNum":"   73","line":""},
{"lineNum":"   74","line":"static void secp256k1_ge_set_gej_zinv(secp256k1_ge *r, const secp256k1_gej *a, const secp256k1_fe *zi) {","class":"lineCov","hits":"1","order":"4434","possible_hits":"1",},
{"lineNum":"   75","line":"    secp256k1_fe zi2;"},
{"lineNum":"   76","line":"    secp256k1_fe zi3;"},
{"lineNum":"   77","line":"    secp256k1_fe_sqr(&zi2, zi);","class":"lineCov","hits":"1","order":"4435","possible_hits":"1",},
{"lineNum":"   78","line":"    secp256k1_fe_mul(&zi3, &zi2, zi);","class":"lineCov","hits":"1","order":"4436","possible_hits":"1",},
{"lineNum":"   79","line":"    secp256k1_fe_mul(&r->x, &a->x, &zi2);","class":"lineCov","hits":"1","order":"4437","possible_hits":"1",},
{"lineNum":"   80","line":"    secp256k1_fe_mul(&r->y, &a->y, &zi3);","class":"lineCov","hits":"1","order":"4438","possible_hits":"1",},
{"lineNum":"   81","line":"    r->infinity = a->infinity;","class":"lineCov","hits":"1","order":"4439","possible_hits":"1",},
{"lineNum":"   82","line":"}","class":"linePartCov","hits":"1","order":"4440","possible_hits":"2",},
{"lineNum":"   83","line":""},
{"lineNum":"   84","line":"static void secp256k1_ge_set_xy(secp256k1_ge *r, const secp256k1_fe *x, const secp256k1_fe *y) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"   85","line":"    r->infinity = 0;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"   86","line":"    r->x = *x;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"   87","line":"    r->y = *y;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"   88","line":"}","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"   89","line":""},
{"lineNum":"   90","line":"static int secp256k1_ge_is_infinity(const secp256k1_ge *a) {","class":"lineCov","hits":"1","order":"5111","possible_hits":"1",},
{"lineNum":"   91","line":"    return a->infinity;","class":"lineCov","hits":"1","order":"5112","possible_hits":"1",},
{"lineNum":"   92","line":"}","class":"linePartCov","hits":"1","order":"5113","possible_hits":"2",},
{"lineNum":"   93","line":""},
{"lineNum":"   94","line":"static void secp256k1_ge_neg(secp256k1_ge *r, const secp256k1_ge *a) {","class":"lineCov","hits":"1","order":"5788","possible_hits":"1",},
{"lineNum":"   95","line":"    *r = *a;","class":"lineCov","hits":"1","order":"5789","possible_hits":"1",},
{"lineNum":"   96","line":"    secp256k1_fe_normalize_weak(&r->y);","class":"lineCov","hits":"1","order":"5790","possible_hits":"1",},
{"lineNum":"   97","line":"    secp256k1_fe_negate(&r->y, &r->y, 1);","class":"lineCov","hits":"1","order":"5791","possible_hits":"1",},
{"lineNum":"   98","line":"}","class":"linePartCov","hits":"1","order":"5792","possible_hits":"2",},
{"lineNum":"   99","line":""},
{"lineNum":"  100","line":"static void secp256k1_ge_set_gej(secp256k1_ge *r, secp256k1_gej *a) {","class":"lineCov","hits":"1","order":"4989","possible_hits":"1",},
{"lineNum":"  101","line":"    secp256k1_fe z2, z3;"},
{"lineNum":"  102","line":"    r->infinity = a->infinity;","class":"lineCov","hits":"1","order":"4990","possible_hits":"1",},
{"lineNum":"  103","line":"    secp256k1_fe_inv(&a->z, &a->z);","class":"lineCov","hits":"1","order":"4991","possible_hits":"1",},
{"lineNum":"  104","line":"    secp256k1_fe_sqr(&z2, &a->z);","class":"lineCov","hits":"1","order":"4992","possible_hits":"1",},
{"lineNum":"  105","line":"    secp256k1_fe_mul(&z3, &a->z, &z2);","class":"lineCov","hits":"1","order":"4993","possible_hits":"1",},
{"lineNum":"  106","line":"    secp256k1_fe_mul(&a->x, &a->x, &z2);","class":"lineCov","hits":"1","order":"4994","possible_hits":"1",},
{"lineNum":"  107","line":"    secp256k1_fe_mul(&a->y, &a->y, &z3);","class":"lineCov","hits":"1","order":"4995","possible_hits":"1",},
{"lineNum":"  108","line":"    secp256k1_fe_set_int(&a->z, 1);","class":"lineCov","hits":"1","order":"4996","possible_hits":"1",},
{"lineNum":"  109","line":"    r->x = a->x;","class":"lineCov","hits":"1","order":"4997","possible_hits":"1",},
{"lineNum":"  110","line":"    r->y = a->y;","class":"lineCov","hits":"1","order":"4998","possible_hits":"1",},
{"lineNum":"  111","line":"}","class":"linePartCov","hits":"1","order":"4999","possible_hits":"2",},
{"lineNum":"  112","line":""},
{"lineNum":"  113","line":"static void secp256k1_ge_set_gej_var(secp256k1_ge *r, secp256k1_gej *a) {","class":"lineCov","hits":"1","order":"5832","possible_hits":"1",},
{"lineNum":"  114","line":"    secp256k1_fe z2, z3;"},
{"lineNum":"  115","line":"    r->infinity = a->infinity;","class":"lineCov","hits":"1","order":"5833","possible_hits":"1",},
{"lineNum":"  116","line":"    if (a->infinity) {","class":"lineCov","hits":"1","order":"5834","possible_hits":"1",},
{"lineNum":"  117","line":"        return;"},
{"lineNum":"  118","line":"    }"},
{"lineNum":"  119","line":"    secp256k1_fe_inv_var(&a->z, &a->z);","class":"lineCov","hits":"1","order":"5835","possible_hits":"1",},
{"lineNum":"  120","line":"    secp256k1_fe_sqr(&z2, &a->z);","class":"lineCov","hits":"1","order":"5836","possible_hits":"1",},
{"lineNum":"  121","line":"    secp256k1_fe_mul(&z3, &a->z, &z2);","class":"lineCov","hits":"1","order":"5837","possible_hits":"1",},
{"lineNum":"  122","line":"    secp256k1_fe_mul(&a->x, &a->x, &z2);","class":"lineCov","hits":"1","order":"5838","possible_hits":"1",},
{"lineNum":"  123","line":"    secp256k1_fe_mul(&a->y, &a->y, &z3);","class":"lineCov","hits":"1","order":"5839","possible_hits":"1",},
{"lineNum":"  124","line":"    secp256k1_fe_set_int(&a->z, 1);","class":"lineCov","hits":"1","order":"5840","possible_hits":"1",},
{"lineNum":"  125","line":"    r->x = a->x;","class":"lineCov","hits":"1","order":"5841","possible_hits":"1",},
{"lineNum":"  126","line":"    r->y = a->y;","class":"lineCov","hits":"1","order":"5842","possible_hits":"1",},
{"lineNum":"  127","line":"}","class":"linePartCov","hits":"1","order":"5843","possible_hits":"2",},
{"lineNum":"  128","line":""},
{"lineNum":"  129","line":"static void secp256k1_ge_set_all_gej_var(secp256k1_ge *r, const secp256k1_gej *a, size_t len, const secp256k1_callback *cb) {","class":"lineCov","hits":"1","order":"4333","possible_hits":"1",},
{"lineNum":"  130","line":"    secp256k1_fe *az;"},
{"lineNum":"  131","line":"    secp256k1_fe *azi;"},
{"lineNum":"  132","line":"    size_t i;"},
{"lineNum":"  133","line":"    size_t count = 0;","class":"lineCov","hits":"1","order":"4334","possible_hits":"1",},
{"lineNum":"  134","line":"    az = (secp256k1_fe *)checked_malloc(cb, sizeof(secp256k1_fe) * len);","class":"lineCov","hits":"1","order":"4335","possible_hits":"1",},
{"lineNum":"  135","line":"    for (i = 0; i < len; i++) {","class":"lineCov","hits":"2","order":"4336","possible_hits":"2",},
{"lineNum":"  136","line":"        if (!a[i].infinity) {","class":"lineCov","hits":"1","order":"4338","possible_hits":"1",},
{"lineNum":"  137","line":"            az[count++] = a[i].z;","class":"lineCov","hits":"1","order":"4340","possible_hits":"1",},
{"lineNum":"  138","line":"        }"},
{"lineNum":"  139","line":"    }"},
{"lineNum":"  140","line":""},
{"lineNum":"  141","line":"    azi = (secp256k1_fe *)checked_malloc(cb, sizeof(secp256k1_fe) * count);","class":"lineCov","hits":"1","order":"4343","possible_hits":"1",},
{"lineNum":"  142","line":"    secp256k1_fe_inv_all_var(azi, az, count);","class":"lineCov","hits":"1","order":"4344","possible_hits":"1",},
{"lineNum":"  143","line":"    free(az);","class":"lineCov","hits":"1","order":"4428","possible_hits":"1",},
{"lineNum":"  144","line":""},
{"lineNum":"  145","line":"    count = 0;","class":"lineCov","hits":"1","order":"4429","possible_hits":"1",},
{"lineNum":"  146","line":"    for (i = 0; i < len; i++) {","class":"lineCov","hits":"2","order":"4430","possible_hits":"2",},
{"lineNum":"  147","line":"        r[i].infinity = a[i].infinity;","class":"lineCov","hits":"1","order":"4431","possible_hits":"1",},
{"lineNum":"  148","line":"        if (!a[i].infinity) {","class":"lineCov","hits":"1","order":"4432","possible_hits":"1",},
{"lineNum":"  149","line":"            secp256k1_ge_set_gej_zinv(&r[i], &a[i], &azi[count++]);","class":"lineCov","hits":"1","order":"4433","possible_hits":"1",},
{"lineNum":"  150","line":"        }"},
{"lineNum":"  151","line":"    }"},
{"lineNum":"  152","line":"    free(azi);","class":"lineCov","hits":"1","order":"4441","possible_hits":"1",},
{"lineNum":"  153","line":"}","class":"linePartCov","hits":"1","order":"4442","possible_hits":"2",},
{"lineNum":"  154","line":""},
{"lineNum":"  155","line":"static void secp256k1_ge_set_table_gej_var(secp256k1_ge *r, const secp256k1_gej *a, const secp256k1_fe *zr, size_t len) {","class":"lineCov","hits":"1","order":"4923","possible_hits":"1",},
{"lineNum":"  156","line":"    size_t i = len - 1;","class":"lineCov","hits":"1","order":"4924","possible_hits":"1",},
{"lineNum":"  157","line":"    secp256k1_fe zi;"},
{"lineNum":"  158","line":""},
{"lineNum":"  159","line":"    if (len > 0) {","class":"lineCov","hits":"1","order":"4925","possible_hits":"1",},
{"lineNum":"  160","line":"        /* Compute the inverse of the last z coordinate, and use it to compute the last affine output. */"},
{"lineNum":"  161","line":"        secp256k1_fe_inv(&zi, &a[i].z);","class":"lineCov","hits":"1","order":"4926","possible_hits":"1",},
{"lineNum":"  162","line":"        secp256k1_ge_set_gej_zinv(&r[i], &a[i], &zi);","class":"lineCov","hits":"1","order":"4927","possible_hits":"1",},
{"lineNum":"  163","line":""},
{"lineNum":"  164","line":"        /* Work out way backwards, using the z-ratios to scale the x/y values. */"},
{"lineNum":"  165","line":"        while (i > 0) {","class":"lineCov","hits":"2","order":"4928","possible_hits":"2",},
{"lineNum":"  166","line":"            secp256k1_fe_mul(&zi, &zi, &zr[i]);","class":"lineCov","hits":"1","order":"4929","possible_hits":"1",},
{"lineNum":"  167","line":"            i--;","class":"lineCov","hits":"1","order":"4930","possible_hits":"1",},
{"lineNum":"  168","line":"            secp256k1_ge_set_gej_zinv(&r[i], &a[i], &zi);","class":"lineCov","hits":"1","order":"4931","possible_hits":"1",},
{"lineNum":"  169","line":"        }"},
{"lineNum":"  170","line":"    }"},
{"lineNum":"  171","line":"}","class":"linePartCov","hits":"1","order":"4932","possible_hits":"2",},
{"lineNum":"  172","line":""},
{"lineNum":"  173","line":"static void secp256k1_ge_globalz_set_table_gej(size_t len, secp256k1_ge *r, secp256k1_fe *globalz, const secp256k1_gej *a, const secp256k1_fe *zr) {","class":"lineCov","hits":"1","order":"5737","possible_hits":"1",},
{"lineNum":"  174","line":"    size_t i = len - 1;","class":"lineCov","hits":"1","order":"5738","possible_hits":"1",},
{"lineNum":"  175","line":"    secp256k1_fe zs;"},
{"lineNum":"  176","line":""},
{"lineNum":"  177","line":"    if (len > 0) {","class":"lineCov","hits":"1","order":"5739","possible_hits":"1",},
{"lineNum":"  178","line":"        /* The z of the final point gives us the \"global Z\" for the table. */"},
{"lineNum":"  179","line":"        r[i].x = a[i].x;","class":"lineCov","hits":"1","order":"5740","possible_hits":"1",},
{"lineNum":"  180","line":"        r[i].y = a[i].y;","class":"lineCov","hits":"1","order":"5741","possible_hits":"1",},
{"lineNum":"  181","line":"        *globalz = a[i].z;","class":"lineCov","hits":"1","order":"5742","possible_hits":"1",},
{"lineNum":"  182","line":"        r[i].infinity = 0;","class":"lineCov","hits":"1","order":"5743","possible_hits":"1",},
{"lineNum":"  183","line":"        zs = zr[i];","class":"lineCov","hits":"1","order":"5744","possible_hits":"1",},
{"lineNum":"  184","line":""},
{"lineNum":"  185","line":"        /* Work our way backwards, using the z-ratios to scale the x/y values. */"},
{"lineNum":"  186","line":"        while (i > 0) {","class":"lineCov","hits":"2","order":"5745","possible_hits":"2",},
{"lineNum":"  187","line":"            if (i != len - 1) {","class":"lineCov","hits":"1","order":"5746","possible_hits":"1",},
{"lineNum":"  188","line":"                secp256k1_fe_mul(&zs, &zs, &zr[i]);","class":"lineCov","hits":"1","order":"5749","possible_hits":"1",},
{"lineNum":"  189","line":"            }"},
{"lineNum":"  190","line":"            i--;","class":"lineCov","hits":"1","order":"5747","possible_hits":"1",},
{"lineNum":"  191","line":"            secp256k1_ge_set_gej_zinv(&r[i], &a[i], &zs);","class":"lineCov","hits":"1","order":"5748","possible_hits":"1",},
{"lineNum":"  192","line":"        }"},
{"lineNum":"  193","line":"    }"},
{"lineNum":"  194","line":"}","class":"linePartCov","hits":"1","order":"5750","possible_hits":"2",},
{"lineNum":"  195","line":""},
{"lineNum":"  196","line":"static void secp256k1_gej_set_infinity(secp256k1_gej *r) {","class":"lineCov","hits":"1","order":"5775","possible_hits":"1",},
{"lineNum":"  197","line":"    r->infinity = 1;","class":"lineCov","hits":"1","order":"5776","possible_hits":"1",},
{"lineNum":"  198","line":"    secp256k1_fe_clear(&r->x);","class":"lineCov","hits":"1","order":"5777","possible_hits":"1",},
{"lineNum":"  199","line":"    secp256k1_fe_clear(&r->y);","class":"lineCov","hits":"1","order":"5778","possible_hits":"1",},
{"lineNum":"  200","line":"    secp256k1_fe_clear(&r->z);","class":"lineCov","hits":"1","order":"5779","possible_hits":"1",},
{"lineNum":"  201","line":"}","class":"linePartCov","hits":"1","order":"5780","possible_hits":"2",},
{"lineNum":"  202","line":""},
{"lineNum":"  203","line":"static void secp256k1_ge_set_infinity(secp256k1_ge *r) {"},
{"lineNum":"  204","line":"    r->infinity = 1;"},
{"lineNum":"  205","line":"    secp256k1_fe_clear(&r->x);"},
{"lineNum":"  206","line":"    secp256k1_fe_clear(&r->y);"},
{"lineNum":"  207","line":"}"},
{"lineNum":"  208","line":""},
{"lineNum":"  209","line":"static void secp256k1_gej_clear(secp256k1_gej *r) {","class":"lineCov","hits":"1","order":"4810","possible_hits":"1",},
{"lineNum":"  210","line":"    r->infinity = 0;","class":"lineCov","hits":"1","order":"4811","possible_hits":"1",},
{"lineNum":"  211","line":"    secp256k1_fe_clear(&r->x);","class":"lineCov","hits":"1","order":"4812","possible_hits":"1",},
{"lineNum":"  212","line":"    secp256k1_fe_clear(&r->y);","class":"lineCov","hits":"1","order":"4813","possible_hits":"1",},
{"lineNum":"  213","line":"    secp256k1_fe_clear(&r->z);","class":"lineCov","hits":"1","order":"4814","possible_hits":"1",},
{"lineNum":"  214","line":"}","class":"linePartCov","hits":"1","order":"4815","possible_hits":"2",},
{"lineNum":"  215","line":""},
{"lineNum":"  216","line":"static void secp256k1_ge_clear(secp256k1_ge *r) {","class":"lineCov","hits":"1","order":"2649","possible_hits":"1",},
{"lineNum":"  217","line":"    r->infinity = 0;","class":"lineCov","hits":"1","order":"2650","possible_hits":"1",},
{"lineNum":"  218","line":"    secp256k1_fe_clear(&r->x);","class":"lineCov","hits":"1","order":"2651","possible_hits":"1",},
{"lineNum":"  219","line":"    secp256k1_fe_clear(&r->y);","class":"lineCov","hits":"1","order":"2656","possible_hits":"1",},
{"lineNum":"  220","line":"}","class":"linePartCov","hits":"1","order":"2657","possible_hits":"2",},
{"lineNum":"  221","line":""},
{"lineNum":"  222","line":"static int secp256k1_ge_set_xquad(secp256k1_ge *r, const secp256k1_fe *x) {","class":"lineCov","hits":"1","order":"2399","possible_hits":"1",},
{"lineNum":"  223","line":"    secp256k1_fe x2, x3, c;"},
{"lineNum":"  224","line":"    r->x = *x;","class":"lineCov","hits":"1","order":"2400","possible_hits":"1",},
{"lineNum":"  225","line":"    secp256k1_fe_sqr(&x2, x);","class":"lineCov","hits":"1","order":"2401","possible_hits":"1",},
{"lineNum":"  226","line":"    secp256k1_fe_mul(&x3, x, &x2);","class":"lineCov","hits":"1","order":"2443","possible_hits":"1",},
{"lineNum":"  227","line":"    r->infinity = 0;","class":"lineCov","hits":"1","order":"2493","possible_hits":"1",},
{"lineNum":"  228","line":"    secp256k1_fe_set_int(&c, CURVE_B);","class":"lineCov","hits":"1","order":"2494","possible_hits":"1",},
{"lineNum":"  229","line":"    secp256k1_fe_add(&c, &x3);","class":"lineCov","hits":"1","order":"2499","possible_hits":"1",},
{"lineNum":"  230","line":"    return secp256k1_fe_sqrt(&r->y, &c);","class":"lineCov","hits":"1","order":"2507","possible_hits":"1",},
{"lineNum":"  231","line":"}","class":"linePartCov","hits":"1","order":"2588","possible_hits":"2",},
{"lineNum":"  232","line":""},
{"lineNum":"  233","line":"static int secp256k1_ge_set_xo_var(secp256k1_ge *r, const secp256k1_fe *x, int odd) {","class":"lineCov","hits":"1","order":"2397","possible_hits":"1",},
{"lineNum":"  234","line":"    if (!secp256k1_ge_set_xquad(r, x)) {","class":"lineCov","hits":"1","order":"2398","possible_hits":"1",},
{"lineNum":"  235","line":"        return 0;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  236","line":"    }"},
{"lineNum":"  237","line":"    secp256k1_fe_normalize_var(&r->y);","class":"lineCov","hits":"1","order":"2589","possible_hits":"1",},
{"lineNum":"  238","line":"    if (secp256k1_fe_is_odd(&r->y) != odd) {","class":"lineCov","hits":"1","order":"2603","possible_hits":"1",},
{"lineNum":"  239","line":"        secp256k1_fe_negate(&r->y, &r->y, 1);","class":"lineCov","hits":"1","order":"2607","possible_hits":"1",},
{"lineNum":"  240","line":"    }"},
{"lineNum":"  241","line":"    return 1;","class":"lineCov","hits":"1","order":"2608","possible_hits":"1",},
{"lineNum":"  242","line":""},
{"lineNum":"  243","line":"}","class":"linePartCov","hits":"1","order":"2609","possible_hits":"2",},
{"lineNum":"  244","line":""},
{"lineNum":"  245","line":"static void secp256k1_gej_set_ge(secp256k1_gej *r, const secp256k1_ge *a) {","class":"lineCov","hits":"1","order":"4138","possible_hits":"1",},
{"lineNum":"  246","line":"   r->infinity = a->infinity;","class":"lineCov","hits":"1","order":"4139","possible_hits":"1",},
{"lineNum":"  247","line":"   r->x = a->x;","class":"lineCov","hits":"1","order":"4140","possible_hits":"1",},
{"lineNum":"  248","line":"   r->y = a->y;","class":"lineCov","hits":"1","order":"4141","possible_hits":"1",},
{"lineNum":"  249","line":"   secp256k1_fe_set_int(&r->z, 1);","class":"lineCov","hits":"1","order":"4143","possible_hits":"1",},
{"lineNum":"  250","line":"}","class":"linePartCov","hits":"1","order":"4145","possible_hits":"2",},
{"lineNum":"  251","line":""},
{"lineNum":"  252","line":"static int secp256k1_gej_eq_x_var(const secp256k1_fe *x, const secp256k1_gej *a) {","class":"lineCov","hits":"1","order":"5952","possible_hits":"1",},
{"lineNum":"  253","line":"    secp256k1_fe r, r2;"},
{"lineNum":"  254","line":"    VERIFY_CHECK(!a->infinity);"},
{"lineNum":"  255","line":"    secp256k1_fe_sqr(&r, &a->z); secp256k1_fe_mul(&r, &r, x);","class":"lineCov","hits":"1","order":"5953","possible_hits":"1",},
{"lineNum":"  256","line":"    r2 = a->x; secp256k1_fe_normalize_weak(&r2);","class":"lineCov","hits":"1","order":"5954","possible_hits":"1",},
{"lineNum":"  257","line":"    return secp256k1_fe_equal_var(&r, &r2);","class":"lineCov","hits":"1","order":"5955","possible_hits":"1",},
{"lineNum":"  258","line":"}","class":"linePartCov","hits":"1","order":"5971","possible_hits":"2",},
{"lineNum":"  259","line":""},
{"lineNum":"  260","line":"static void secp256k1_gej_neg(secp256k1_gej *r, const secp256k1_gej *a) {","class":"lineCov","hits":"1","order":"4317","possible_hits":"1",},
{"lineNum":"  261","line":"    r->infinity = a->infinity;","class":"lineCov","hits":"1","order":"4318","possible_hits":"1",},
{"lineNum":"  262","line":"    r->x = a->x;","class":"lineCov","hits":"1","order":"4320","possible_hits":"1",},
{"lineNum":"  263","line":"    r->y = a->y;","class":"lineCov","hits":"1","order":"4322","possible_hits":"1",},
{"lineNum":"  264","line":"    r->z = a->z;","class":"lineCov","hits":"1","order":"4324","possible_hits":"1",},
{"lineNum":"  265","line":"    secp256k1_fe_normalize_weak(&r->y);","class":"lineCov","hits":"1","order":"4326","possible_hits":"1",},
{"lineNum":"  266","line":"    secp256k1_fe_negate(&r->y, &r->y, 1);","class":"lineCov","hits":"1","order":"4328","possible_hits":"1",},
{"lineNum":"  267","line":"}","class":"linePartCov","hits":"1","order":"4329","possible_hits":"2",},
{"lineNum":"  268","line":""},
{"lineNum":"  269","line":"static int secp256k1_gej_is_infinity(const secp256k1_gej *a) {","class":"lineCov","hits":"1","order":"5658","possible_hits":"1",},
{"lineNum":"  270","line":"    return a->infinity;","class":"lineCov","hits":"1","order":"5659","possible_hits":"1",},
{"lineNum":"  271","line":"}","class":"linePartCov","hits":"1","order":"5660","possible_hits":"2",},
{"lineNum":"  272","line":""},
{"lineNum":"  273","line":"static int secp256k1_gej_is_valid_var(const secp256k1_gej *a) {"},
{"lineNum":"  274","line":"    secp256k1_fe y2, x3, z2, z6;"},
{"lineNum":"  275","line":"    if (a->infinity) {"},
{"lineNum":"  276","line":"        return 0;"},
{"lineNum":"  277","line":"    }"},
{"lineNum":"  278","line":"    /** y^2 = x^3 + 7"},
{"lineNum":"  279","line":"     *  (Y/Z^3)^2 = (X/Z^2)^3 + 7"},
{"lineNum":"  280","line":"     *  Y^2 / Z^6 = X^3 / Z^6 + 7"},
{"lineNum":"  281","line":"     *  Y^2 = X^3 + 7*Z^6"},
{"lineNum":"  282","line":"     */"},
{"lineNum":"  283","line":"    secp256k1_fe_sqr(&y2, &a->y);"},
{"lineNum":"  284","line":"    secp256k1_fe_sqr(&x3, &a->x); secp256k1_fe_mul(&x3, &x3, &a->x);"},
{"lineNum":"  285","line":"    secp256k1_fe_sqr(&z2, &a->z);"},
{"lineNum":"  286","line":"    secp256k1_fe_sqr(&z6, &z2); secp256k1_fe_mul(&z6, &z6, &z2);"},
{"lineNum":"  287","line":"    secp256k1_fe_mul_int(&z6, CURVE_B);"},
{"lineNum":"  288","line":"    secp256k1_fe_add(&x3, &z6);"},
{"lineNum":"  289","line":"    secp256k1_fe_normalize_weak(&x3);"},
{"lineNum":"  290","line":"    return secp256k1_fe_equal_var(&y2, &x3);"},
{"lineNum":"  291","line":"}"},
{"lineNum":"  292","line":""},
{"lineNum":"  293","line":"static int secp256k1_ge_is_valid_var(const secp256k1_ge *a) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  294","line":"    secp256k1_fe y2, x3, c;"},
{"lineNum":"  295","line":"    if (a->infinity) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  296","line":"        return 0;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  297","line":"    }"},
{"lineNum":"  298","line":"    /* y^2 = x^3 + 7 */"},
{"lineNum":"  299","line":"    secp256k1_fe_sqr(&y2, &a->y);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  300","line":"    secp256k1_fe_sqr(&x3, &a->x); secp256k1_fe_mul(&x3, &x3, &a->x);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  301","line":"    secp256k1_fe_set_int(&c, CURVE_B);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  302","line":"    secp256k1_fe_add(&x3, &c);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  303","line":"    secp256k1_fe_normalize_weak(&x3);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  304","line":"    return secp256k1_fe_equal_var(&y2, &x3);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  305","line":"}","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  306","line":""},
{"lineNum":"  307","line":"static void secp256k1_gej_double_var(secp256k1_gej *r, const secp256k1_gej *a, secp256k1_fe *rzr) {","class":"lineCov","hits":"1","order":"4251","possible_hits":"1",},
{"lineNum":"  308","line":"    /* Operations: 3 mul, 4 sqr, 0 normalize, 12 mul_int/add/negate."},
{"lineNum":"  309","line":"     *"},
{"lineNum":"  310","line":"     * Note that there is an implementation described at"},
{"lineNum":"  311","line":"     *     https://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-0.html#doubling-dbl-2009-l"},
{"lineNum":"  312","line":"     * which trades a multiply for a square, but in practice this is actually slower,"},
{"lineNum":"  313","line":"     * mainly because it requires more normalizations."},
{"lineNum":"  314","line":"     */"},
{"lineNum":"  315","line":"    secp256k1_fe t1,t2,t3,t4;"},
{"lineNum":"  316","line":"    /** For secp256k1, 2Q is infinity if and only if Q is infinity. This is because if 2Q = infinity,"},
{"lineNum":"  317","line":"     *  Q must equal -Q, or that Q.y == -(Q.y), or Q.y is 0. For a point on y^2 = x^3 + 7 to have"},
{"lineNum":"  318","line":"     *  y=0, x^3 must be -7 mod p. However, -7 has no cube root mod p."},
{"lineNum":"  319","line":"     *"},
{"lineNum":"  320","line":"     *  Having said this, if this function receives a point on a sextic twist, e.g. by"},
{"lineNum":"  321","line":"     *  a fault attack, it is possible for y to be 0. This happens for y^2 = x^3 + 6,"},
{"lineNum":"  322","line":"     *  since -6 does have a cube root mod p. For this point, this function will not set"},
{"lineNum":"  323","line":"     *  the infinity flag even though the point doubles to infinity, and the result"},
{"lineNum":"  324","line":"     *  point will be gibberish (z = 0 but infinity = 0)."},
{"lineNum":"  325","line":"     */"},
{"lineNum":"  326","line":"    r->infinity = a->infinity;","class":"lineCov","hits":"1","order":"4252","possible_hits":"1",},
{"lineNum":"  327","line":"    if (r->infinity) {","class":"lineCov","hits":"1","order":"4253","possible_hits":"1",},
{"lineNum":"  328","line":"        if (rzr != NULL) {","class":"lineCov","hits":"1","order":"5783","possible_hits":"1",},
{"lineNum":"  329","line":"            secp256k1_fe_set_int(rzr, 1);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  330","line":"        }"},
{"lineNum":"  331","line":"        return;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  332","line":"    }"},
{"lineNum":"  333","line":""},
{"lineNum":"  334","line":"    if (rzr != NULL) {","class":"lineCov","hits":"1","order":"4254","possible_hits":"1",},
{"lineNum":"  335","line":"        *rzr = a->y;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  336","line":"        secp256k1_fe_normalize_weak(rzr);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  337","line":"        secp256k1_fe_mul_int(rzr, 2);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  338","line":"    }"},
{"lineNum":"  339","line":""},
{"lineNum":"  340","line":"    secp256k1_fe_mul(&r->z, &a->z, &a->y);","class":"lineCov","hits":"1","order":"4255","possible_hits":"1",},
{"lineNum":"  341","line":"    secp256k1_fe_mul_int(&r->z, 2);       /* Z\' = 2*Y*Z (2) */","class":"lineCov","hits":"1","order":"4256","possible_hits":"1",},
{"lineNum":"  342","line":"    secp256k1_fe_sqr(&t1, &a->x);","class":"lineCov","hits":"1","order":"4257","possible_hits":"1",},
{"lineNum":"  343","line":"    secp256k1_fe_mul_int(&t1, 3);         /* T1 = 3*X^2 (3) */","class":"lineCov","hits":"1","order":"4258","possible_hits":"1",},
{"lineNum":"  344","line":"    secp256k1_fe_sqr(&t2, &t1);           /* T2 = 9*X^4 (1) */","class":"lineCov","hits":"1","order":"4259","possible_hits":"1",},
{"lineNum":"  345","line":"    secp256k1_fe_sqr(&t3, &a->y);","class":"lineCov","hits":"1","order":"4260","possible_hits":"1",},
{"lineNum":"  346","line":"    secp256k1_fe_mul_int(&t3, 2);         /* T3 = 2*Y^2 (2) */","class":"lineCov","hits":"1","order":"4261","possible_hits":"1",},
{"lineNum":"  347","line":"    secp256k1_fe_sqr(&t4, &t3);","class":"lineCov","hits":"1","order":"4262","possible_hits":"1",},
{"lineNum":"  348","line":"    secp256k1_fe_mul_int(&t4, 2);         /* T4 = 8*Y^4 (2) */","class":"lineCov","hits":"1","order":"4263","possible_hits":"1",},
{"lineNum":"  349","line":"    secp256k1_fe_mul(&t3, &t3, &a->x);    /* T3 = 2*X*Y^2 (1) */","class":"lineCov","hits":"1","order":"4264","possible_hits":"1",},
{"lineNum":"  350","line":"    r->x = t3;","class":"lineCov","hits":"1","order":"4265","possible_hits":"1",},
{"lineNum":"  351","line":"    secp256k1_fe_mul_int(&r->x, 4);       /* X\' = 8*X*Y^2 (4) */","class":"lineCov","hits":"1","order":"4266","possible_hits":"1",},
{"lineNum":"  352","line":"    secp256k1_fe_negate(&r->x, &r->x, 4); /* X\' = -8*X*Y^2 (5) */","class":"lineCov","hits":"1","order":"4267","possible_hits":"1",},
{"lineNum":"  353","line":"    secp256k1_fe_add(&r->x, &t2);         /* X\' = 9*X^4 - 8*X*Y^2 (6) */","class":"lineCov","hits":"1","order":"4268","possible_hits":"1",},
{"lineNum":"  354","line":"    secp256k1_fe_negate(&t2, &t2, 1);     /* T2 = -9*X^4 (2) */","class":"lineCov","hits":"1","order":"4269","possible_hits":"1",},
{"lineNum":"  355","line":"    secp256k1_fe_mul_int(&t3, 6);         /* T3 = 12*X*Y^2 (6) */","class":"lineCov","hits":"1","order":"4270","possible_hits":"1",},
{"lineNum":"  356","line":"    secp256k1_fe_add(&t3, &t2);           /* T3 = 12*X*Y^2 - 9*X^4 (8) */","class":"lineCov","hits":"1","order":"4271","possible_hits":"1",},
{"lineNum":"  357","line":"    secp256k1_fe_mul(&r->y, &t1, &t3);    /* Y\' = 36*X^3*Y^2 - 27*X^6 (1) */","class":"lineCov","hits":"1","order":"4272","possible_hits":"1",},
{"lineNum":"  358","line":"    secp256k1_fe_negate(&t2, &t4, 2);     /* T2 = -8*Y^4 (3) */","class":"lineCov","hits":"1","order":"4273","possible_hits":"1",},
{"lineNum":"  359","line":"    secp256k1_fe_add(&r->y, &t2);         /* Y\' = 36*X^3*Y^2 - 27*X^6 - 8*Y^4 (4) */","class":"lineCov","hits":"1","order":"4274","possible_hits":"1",},
{"lineNum":"  360","line":"}","class":"linePartCov","hits":"1","order":"4275","possible_hits":"2",},
{"lineNum":"  361","line":""},
{"lineNum":"  362","line":"static SECP256K1_INLINE void secp256k1_gej_double_nonzero(secp256k1_gej *r, const secp256k1_gej *a, secp256k1_fe *rzr) {"},
{"lineNum":"  363","line":"    VERIFY_CHECK(!secp256k1_gej_is_infinity(a));"},
{"lineNum":"  364","line":"    secp256k1_gej_double_var(r, a, rzr);"},
{"lineNum":"  365","line":"}"},
{"lineNum":"  366","line":""},
{"lineNum":"  367","line":"static void secp256k1_gej_add_var(secp256k1_gej *r, const secp256k1_gej *a, const secp256k1_gej *b, secp256k1_fe *rzr) {","class":"lineCov","hits":"1","order":"4224","possible_hits":"1",},
{"lineNum":"  368","line":"    /* Operations: 12 mul, 4 sqr, 2 normalize, 12 mul_int/add/negate */"},
{"lineNum":"  369","line":"    secp256k1_fe z22, z12, u1, u2, s1, s2, h, i, i2, h2, h3, t;"},
{"lineNum":"  370","line":""},
{"lineNum":"  371","line":"    if (a->infinity) {","class":"lineCov","hits":"1","order":"4225","possible_hits":"1",},
{"lineNum":"  372","line":"        VERIFY_CHECK(rzr == NULL);"},
{"lineNum":"  373","line":"        *r = *b;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  374","line":"        return;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  375","line":"    }"},
{"lineNum":"  376","line":""},
{"lineNum":"  377","line":"    if (b->infinity) {","class":"lineCov","hits":"1","order":"4226","possible_hits":"1",},
{"lineNum":"  378","line":"        if (rzr != NULL) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  379","line":"            secp256k1_fe_set_int(rzr, 1);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  380","line":"        }"},
{"lineNum":"  381","line":"        *r = *a;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  382","line":"        return;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  383","line":"    }"},
{"lineNum":"  384","line":""},
{"lineNum":"  385","line":"    r->infinity = 0;","class":"lineCov","hits":"1","order":"4227","possible_hits":"1",},
{"lineNum":"  386","line":"    secp256k1_fe_sqr(&z22, &b->z);","class":"lineCov","hits":"1","order":"4228","possible_hits":"1",},
{"lineNum":"  387","line":"    secp256k1_fe_sqr(&z12, &a->z);","class":"lineCov","hits":"1","order":"4229","possible_hits":"1",},
{"lineNum":"  388","line":"    secp256k1_fe_mul(&u1, &a->x, &z22);","class":"lineCov","hits":"1","order":"4230","possible_hits":"1",},
{"lineNum":"  389","line":"    secp256k1_fe_mul(&u2, &b->x, &z12);","class":"lineCov","hits":"1","order":"4231","possible_hits":"1",},
{"lineNum":"  390","line":"    secp256k1_fe_mul(&s1, &a->y, &z22); secp256k1_fe_mul(&s1, &s1, &b->z);","class":"lineCov","hits":"1","order":"4232","possible_hits":"1",},
{"lineNum":"  391","line":"    secp256k1_fe_mul(&s2, &b->y, &z12); secp256k1_fe_mul(&s2, &s2, &a->z);","class":"lineCov","hits":"1","order":"4233","possible_hits":"1",},
{"lineNum":"  392","line":"    secp256k1_fe_negate(&h, &u1, 1); secp256k1_fe_add(&h, &u2);","class":"lineCov","hits":"1","order":"4234","possible_hits":"1",},
{"lineNum":"  393","line":"    secp256k1_fe_negate(&i, &s1, 1); secp256k1_fe_add(&i, &s2);","class":"lineCov","hits":"1","order":"4235","possible_hits":"1",},
{"lineNum":"  394","line":"    if (secp256k1_fe_normalizes_to_zero_var(&h)) {","class":"lineCov","hits":"1","order":"4236","possible_hits":"1",},
{"lineNum":"  395","line":"        if (secp256k1_fe_normalizes_to_zero_var(&i)) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  396","line":"            secp256k1_gej_double_var(r, a, rzr);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  397","line":"        } else {"},
{"lineNum":"  398","line":"            if (rzr != NULL) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  399","line":"                secp256k1_fe_set_int(rzr, 0);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  400","line":"            }"},
{"lineNum":"  401","line":"            r->infinity = 1;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  402","line":"        }"},
{"lineNum":"  403","line":"        return;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  404","line":"    }"},
{"lineNum":"  405","line":"    secp256k1_fe_sqr(&i2, &i);","class":"lineCov","hits":"1","order":"4237","possible_hits":"1",},
{"lineNum":"  406","line":"    secp256k1_fe_sqr(&h2, &h);","class":"lineCov","hits":"1","order":"4238","possible_hits":"1",},
{"lineNum":"  407","line":"    secp256k1_fe_mul(&h3, &h, &h2);","class":"lineCov","hits":"1","order":"4239","possible_hits":"1",},
{"lineNum":"  408","line":"    secp256k1_fe_mul(&h, &h, &b->z);","class":"lineCov","hits":"1","order":"4240","possible_hits":"1",},
{"lineNum":"  409","line":"    if (rzr != NULL) {","class":"lineCov","hits":"1","order":"4241","possible_hits":"1",},
{"lineNum":"  410","line":"        *rzr = h;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  411","line":"    }"},
{"lineNum":"  412","line":"    secp256k1_fe_mul(&r->z, &a->z, &h);","class":"lineCov","hits":"1","order":"4242","possible_hits":"1",},
{"lineNum":"  413","line":"    secp256k1_fe_mul(&t, &u1, &h2);","class":"lineCov","hits":"1","order":"4243","possible_hits":"1",},
{"lineNum":"  414","line":"    r->x = t; secp256k1_fe_mul_int(&r->x, 2); secp256k1_fe_add(&r->x, &h3); secp256k1_fe_negate(&r->x, &r->x, 3); secp256k1_fe_add(&r->x, &i2);","class":"lineCov","hits":"1","order":"4244","possible_hits":"1",},
{"lineNum":"  415","line":"    secp256k1_fe_negate(&r->y, &r->x, 5); secp256k1_fe_add(&r->y, &t); secp256k1_fe_mul(&r->y, &r->y, &i);","class":"lineCov","hits":"1","order":"4245","possible_hits":"1",},
{"lineNum":"  416","line":"    secp256k1_fe_mul(&h3, &h3, &s1); secp256k1_fe_negate(&h3, &h3, 1);","class":"lineCov","hits":"1","order":"4246","possible_hits":"1",},
{"lineNum":"  417","line":"    secp256k1_fe_add(&r->y, &h3);","class":"lineCov","hits":"1","order":"4247","possible_hits":"1",},
{"lineNum":"  418","line":"}","class":"linePartCov","hits":"1","order":"4248","possible_hits":"2",},
{"lineNum":"  419","line":""},
{"lineNum":"  420","line":"static void secp256k1_gej_add_ge_var(secp256k1_gej *r, const secp256k1_gej *a, const secp256k1_ge *b, secp256k1_fe *rzr) {","class":"lineCov","hits":"1","order":"4155","possible_hits":"1",},
{"lineNum":"  421","line":"    /* 8 mul, 3 sqr, 4 normalize, 12 mul_int/add/negate */"},
{"lineNum":"  422","line":"    secp256k1_fe z12, u1, u2, s1, s2, h, i, i2, h2, h3, t;"},
{"lineNum":"  423","line":"    if (a->infinity) {","class":"lineCov","hits":"1","order":"4156","possible_hits":"1",},
{"lineNum":"  424","line":"        VERIFY_CHECK(rzr == NULL);"},
{"lineNum":"  425","line":"        secp256k1_gej_set_ge(r, b);","class":"lineCov","hits":"1","order":"5794","possible_hits":"1",},
{"lineNum":"  426","line":"        return;","class":"lineCov","hits":"1","order":"5795","possible_hits":"1",},
{"lineNum":"  427","line":"    }"},
{"lineNum":"  428","line":"    if (b->infinity) {","class":"lineCov","hits":"1","order":"4158","possible_hits":"1",},
{"lineNum":"  429","line":"        if (rzr != NULL) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  430","line":"            secp256k1_fe_set_int(rzr, 1);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  431","line":"        }"},
{"lineNum":"  432","line":"        *r = *a;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  433","line":"        return;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  434","line":"    }"},
{"lineNum":"  435","line":"    r->infinity = 0;","class":"lineCov","hits":"1","order":"4160","possible_hits":"1",},
{"lineNum":"  436","line":""},
{"lineNum":"  437","line":"    secp256k1_fe_sqr(&z12, &a->z);","class":"lineCov","hits":"1","order":"4162","possible_hits":"1",},
{"lineNum":"  438","line":"    u1 = a->x; secp256k1_fe_normalize_weak(&u1);","class":"lineCov","hits":"1","order":"4164","possible_hits":"1",},
{"lineNum":"  439","line":"    secp256k1_fe_mul(&u2, &b->x, &z12);","class":"lineCov","hits":"1","order":"4179","possible_hits":"1",},
{"lineNum":"  440","line":"    s1 = a->y; secp256k1_fe_normalize_weak(&s1);","class":"lineCov","hits":"1","order":"4180","possible_hits":"1",},
{"lineNum":"  441","line":"    secp256k1_fe_mul(&s2, &b->y, &z12); secp256k1_fe_mul(&s2, &s2, &a->z);","class":"lineCov","hits":"1","order":"4181","possible_hits":"1",},
{"lineNum":"  442","line":"    secp256k1_fe_negate(&h, &u1, 1); secp256k1_fe_add(&h, &u2);","class":"lineCov","hits":"1","order":"4182","possible_hits":"1",},
{"lineNum":"  443","line":"    secp256k1_fe_negate(&i, &s1, 1); secp256k1_fe_add(&i, &s2);","class":"lineCov","hits":"1","order":"4183","possible_hits":"1",},
{"lineNum":"  444","line":"    if (secp256k1_fe_normalizes_to_zero_var(&h)) {","class":"lineCov","hits":"1","order":"4184","possible_hits":"1",},
{"lineNum":"  445","line":"        if (secp256k1_fe_normalizes_to_zero_var(&i)) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  446","line":"            secp256k1_gej_double_var(r, a, rzr);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  447","line":"        } else {"},
{"lineNum":"  448","line":"            if (rzr != NULL) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  449","line":"                secp256k1_fe_set_int(rzr, 0);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  450","line":"            }"},
{"lineNum":"  451","line":"            r->infinity = 1;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  452","line":"        }"},
{"lineNum":"  453","line":"        return;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  454","line":"    }"},
{"lineNum":"  455","line":"    secp256k1_fe_sqr(&i2, &i);","class":"lineCov","hits":"1","order":"4195","possible_hits":"1",},
{"lineNum":"  456","line":"    secp256k1_fe_sqr(&h2, &h);","class":"lineCov","hits":"1","order":"4196","possible_hits":"1",},
{"lineNum":"  457","line":"    secp256k1_fe_mul(&h3, &h, &h2);","class":"lineCov","hits":"1","order":"4197","possible_hits":"1",},
{"lineNum":"  458","line":"    if (rzr != NULL) {","class":"lineCov","hits":"1","order":"4198","possible_hits":"1",},
{"lineNum":"  459","line":"        *rzr = h;","class":"lineCov","hits":"1","order":"4858","possible_hits":"1",},
{"lineNum":"  460","line":"    }"},
{"lineNum":"  461","line":"    secp256k1_fe_mul(&r->z, &a->z, &h);","class":"lineCov","hits":"1","order":"4199","possible_hits":"1",},
{"lineNum":"  462","line":"    secp256k1_fe_mul(&t, &u1, &h2);","class":"lineCov","hits":"1","order":"4201","possible_hits":"1",},
{"lineNum":"  463","line":"    r->x = t; secp256k1_fe_mul_int(&r->x, 2); secp256k1_fe_add(&r->x, &h3); secp256k1_fe_negate(&r->x, &r->x, 3); secp256k1_fe_add(&r->x, &i2);","class":"lineCov","hits":"1","order":"4203","possible_hits":"1",},
{"lineNum":"  464","line":"    secp256k1_fe_negate(&r->y, &r->x, 5); secp256k1_fe_add(&r->y, &t); secp256k1_fe_mul(&r->y, &r->y, &i);","class":"lineCov","hits":"1","order":"4212","possible_hits":"1",},
{"lineNum":"  465","line":"    secp256k1_fe_mul(&h3, &h3, &s1); secp256k1_fe_negate(&h3, &h3, 1);","class":"lineCov","hits":"1","order":"4214","possible_hits":"1",},
{"lineNum":"  466","line":"    secp256k1_fe_add(&r->y, &h3);","class":"lineCov","hits":"1","order":"4216","possible_hits":"1",},
{"lineNum":"  467","line":"}","class":"linePartCov","hits":"1","order":"4217","possible_hits":"2",},
{"lineNum":"  468","line":""},
{"lineNum":"  469","line":"static void secp256k1_gej_add_zinv_var(secp256k1_gej *r, const secp256k1_gej *a, const secp256k1_ge *b, const secp256k1_fe *bzinv) {","class":"lineCov","hits":"1","order":"5800","possible_hits":"1",},
{"lineNum":"  470","line":"    /* 9 mul, 3 sqr, 4 normalize, 12 mul_int/add/negate */"},
{"lineNum":"  471","line":"    secp256k1_fe az, z12, u1, u2, s1, s2, h, i, i2, h2, h3, t;"},
{"lineNum":"  472","line":""},
{"lineNum":"  473","line":"    if (b->infinity) {","class":"lineCov","hits":"1","order":"5801","possible_hits":"1",},
{"lineNum":"  474","line":"        *r = *a;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  475","line":"        return;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  476","line":"    }"},
{"lineNum":"  477","line":"    if (a->infinity) {","class":"lineCov","hits":"1","order":"5802","possible_hits":"1",},
{"lineNum":"  478","line":"        secp256k1_fe bzinv2, bzinv3;"},
{"lineNum":"  479","line":"        r->infinity = b->infinity;","class":"lineCov","hits":"1","order":"5941","possible_hits":"1",},
{"lineNum":"  480","line":"        secp256k1_fe_sqr(&bzinv2, bzinv);","class":"lineCov","hits":"1","order":"5942","possible_hits":"1",},
{"lineNum":"  481","line":"        secp256k1_fe_mul(&bzinv3, &bzinv2, bzinv);","class":"lineCov","hits":"1","order":"5943","possible_hits":"1",},
{"lineNum":"  482","line":"        secp256k1_fe_mul(&r->x, &b->x, &bzinv2);","class":"lineCov","hits":"1","order":"5944","possible_hits":"1",},
{"lineNum":"  483","line":"        secp256k1_fe_mul(&r->y, &b->y, &bzinv3);","class":"lineCov","hits":"1","order":"5945","possible_hits":"1",},
{"lineNum":"  484","line":"        secp256k1_fe_set_int(&r->z, 1);","class":"lineCov","hits":"1","order":"5946","possible_hits":"1",},
{"lineNum":"  485","line":"        return;","class":"lineCov","hits":"1","order":"5947","possible_hits":"1",},
{"lineNum":"  486","line":"    }"},
{"lineNum":"  487","line":"    r->infinity = 0;","class":"lineCov","hits":"1","order":"5803","possible_hits":"1",},
{"lineNum":"  488","line":""},
{"lineNum":"  489","line":"    /** We need to calculate (rx,ry,rz) = (ax,ay,az) + (bx,by,1/bzinv). Due to"},
{"lineNum":"  490","line":"     *  secp256k1\'s isomorphism we can multiply the Z coordinates on both sides"},
{"lineNum":"  491","line":"     *  by bzinv, and get: (rx,ry,rz*bzinv) = (ax,ay,az*bzinv) + (bx,by,1)."},
{"lineNum":"  492","line":"     *  This means that (rx,ry,rz) can be calculated as"},
{"lineNum":"  493","line":"     *  (ax,ay,az*bzinv) + (bx,by,1), when not applying the bzinv factor to rz."},
{"lineNum":"  494","line":"     *  The variable az below holds the modified Z coordinate for a, which is used"},
{"lineNum":"  495","line":"     *  for the computation of rx and ry, but not for rz."},
{"lineNum":"  496","line":"     */"},
{"lineNum":"  497","line":"    secp256k1_fe_mul(&az, &a->z, bzinv);","class":"lineCov","hits":"1","order":"5804","possible_hits":"1",},
{"lineNum":"  498","line":""},
{"lineNum":"  499","line":"    secp256k1_fe_sqr(&z12, &az);","class":"lineCov","hits":"1","order":"5805","possible_hits":"1",},
{"lineNum":"  500","line":"    u1 = a->x; secp256k1_fe_normalize_weak(&u1);","class":"lineCov","hits":"1","order":"5806","possible_hits":"1",},
{"lineNum":"  501","line":"    secp256k1_fe_mul(&u2, &b->x, &z12);","class":"lineCov","hits":"1","order":"5807","possible_hits":"1",},
{"lineNum":"  502","line":"    s1 = a->y; secp256k1_fe_normalize_weak(&s1);","class":"lineCov","hits":"1","order":"5808","possible_hits":"1",},
{"lineNum":"  503","line":"    secp256k1_fe_mul(&s2, &b->y, &z12); secp256k1_fe_mul(&s2, &s2, &az);","class":"lineCov","hits":"1","order":"5809","possible_hits":"1",},
{"lineNum":"  504","line":"    secp256k1_fe_negate(&h, &u1, 1); secp256k1_fe_add(&h, &u2);","class":"lineCov","hits":"1","order":"5810","possible_hits":"1",},
{"lineNum":"  505","line":"    secp256k1_fe_negate(&i, &s1, 1); secp256k1_fe_add(&i, &s2);","class":"lineCov","hits":"1","order":"5811","possible_hits":"1",},
{"lineNum":"  506","line":"    if (secp256k1_fe_normalizes_to_zero_var(&h)) {","class":"lineCov","hits":"1","order":"5812","possible_hits":"1",},
{"lineNum":"  507","line":"        if (secp256k1_fe_normalizes_to_zero_var(&i)) {","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  508","line":"            secp256k1_gej_double_var(r, a, NULL);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  509","line":"        } else {"},
{"lineNum":"  510","line":"            r->infinity = 1;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  511","line":"        }"},
{"lineNum":"  512","line":"        return;","class":"lineNoCov","hits":"0","possible_hits":"2",},
{"lineNum":"  513","line":"    }"},
{"lineNum":"  514","line":"    secp256k1_fe_sqr(&i2, &i);","class":"lineCov","hits":"1","order":"5813","possible_hits":"1",},
{"lineNum":"  515","line":"    secp256k1_fe_sqr(&h2, &h);","class":"lineCov","hits":"1","order":"5814","possible_hits":"1",},
{"lineNum":"  516","line":"    secp256k1_fe_mul(&h3, &h, &h2);","class":"lineCov","hits":"1","order":"5815","possible_hits":"1",},
{"lineNum":"  517","line":"    r->z = a->z; secp256k1_fe_mul(&r->z, &r->z, &h);","class":"lineCov","hits":"1","order":"5816","possible_hits":"1",},
{"lineNum":"  518","line":"    secp256k1_fe_mul(&t, &u1, &h2);","class":"lineCov","hits":"1","order":"5817","possible_hits":"1",},
{"lineNum":"  519","line":"    r->x = t; secp256k1_fe_mul_int(&r->x, 2); secp256k1_fe_add(&r->x, &h3); secp256k1_fe_negate(&r->x, &r->x, 3); secp256k1_fe_add(&r->x, &i2);","class":"lineCov","hits":"1","order":"5818","possible_hits":"1",},
{"lineNum":"  520","line":"    secp256k1_fe_negate(&r->y, &r->x, 5); secp256k1_fe_add(&r->y, &t); secp256k1_fe_mul(&r->y, &r->y, &i);","class":"lineCov","hits":"1","order":"5819","possible_hits":"1",},
{"lineNum":"  521","line":"    secp256k1_fe_mul(&h3, &h3, &s1); secp256k1_fe_negate(&h3, &h3, 1);","class":"lineCov","hits":"1","order":"5820","possible_hits":"1",},
{"lineNum":"  522","line":"    secp256k1_fe_add(&r->y, &h3);","class":"lineCov","hits":"1","order":"5821","possible_hits":"1",},
{"lineNum":"  523","line":"}","class":"linePartCov","hits":"1","order":"5822","possible_hits":"2",},
{"lineNum":"  524","line":""},
{"lineNum":"  525","line":""},
{"lineNum":"  526","line":"static void secp256k1_gej_add_ge(secp256k1_gej *r, const secp256k1_gej *a, const secp256k1_ge *b) {","class":"lineCov","hits":"1","order":"4729","possible_hits":"1",},
{"lineNum":"  527","line":"    /* Operations: 7 mul, 5 sqr, 4 normalize, 21 mul_int/add/negate/cmov */"},
{"lineNum":"  528","line":"    static const secp256k1_fe fe_1 = SECP256K1_FE_CONST(0, 0, 0, 0, 0, 0, 0, 1);"},
{"lineNum":"  529","line":"    secp256k1_fe zz, u1, u2, s1, s2, t, tt, m, n, q, rr;"},
{"lineNum":"  530","line":"    secp256k1_fe m_alt, rr_alt;"},
{"lineNum":"  531","line":"    int infinity, degenerate;"},
{"lineNum":"  532","line":"    VERIFY_CHECK(!b->infinity);"},
{"lineNum":"  533","line":"    VERIFY_CHECK(a->infinity == 0 || a->infinity == 1);","class":"lineCov","hits":"1","order":"4730","possible_hits":"1",},
{"lineNum":"  534","line":""},
{"lineNum":"  535","line":"    /** In:"},
{"lineNum":"  536","line":"     *    Eric Brier and Marc Joye, Weierstrass Elliptic Curves and Side-Channel Attacks."},
{"lineNum":"  537","line":"     *    In D. Naccache and P. Paillier, Eds., Public Key Cryptography, vol. 2274 of Lecture Notes in Computer Science, pages 335-345. Springer-Verlag, 2002."},
{"lineNum":"  538","line":"     *  we find as solution for a unified addition/doubling formula:"},
{"lineNum":"  539","line":"     *    lambda = ((x1 + x2)^2 - x1 * x2 + a) / (y1 + y2), with a = 0 for secp256k1\'s curve equation."},
{"lineNum":"  540","line":"     *    x3 = lambda^2 - (x1 + x2)"},
{"lineNum":"  541","line":"     *    2*y3 = lambda * (x1 + x2 - 2 * x3) - (y1 + y2)."},
{"lineNum":"  542","line":"     *"},
{"lineNum":"  543","line":"     *  Substituting x_i = Xi / Zi^2 and yi = Yi / Zi^3, for i=1,2,3, gives:"},
{"lineNum":"  544","line":"     *    U1 = X1*Z2^2, U2 = X2*Z1^2"},
{"lineNum":"  545","line":"     *    S1 = Y1*Z2^3, S2 = Y2*Z1^3"},
{"lineNum":"  546","line":"     *    Z = Z1*Z2"},
{"lineNum":"  547","line":"     *    T = U1+U2"},
{"lineNum":"  548","line":"     *    M = S1+S2"},
{"lineNum":"  549","line":"     *    Q = T*M^2"},
{"lineNum":"  550","line":"     *    R = T^2-U1*U2"},
{"lineNum":"  551","line":"     *    X3 = 4*(R^2-Q)"},
{"lineNum":"  552","line":"     *    Y3 = 4*(R*(3*Q-2*R^2)-M^4)"},
{"lineNum":"  553","line":"     *    Z3 = 2*M*Z"},
{"lineNum":"  554","line":"     *  (Note that the paper uses xi = Xi / Zi and yi = Yi / Zi instead.)"},
{"lineNum":"  555","line":"     *"},
{"lineNum":"  556","line":"     *  This formula has the benefit of being the same for both addition"},
{"lineNum":"  557","line":"     *  of distinct points and doubling. However, it breaks down in the"},
{"lineNum":"  558","line":"     *  case that either point is infinity, or that y1 = -y2. We handle"},
{"lineNum":"  559","line":"     *  these cases in the following ways:"},
{"lineNum":"  560","line":"     *"},
{"lineNum":"  561","line":"     *    - If b is infinity we simply bail by means of a VERIFY_CHECK."},
{"lineNum":"  562","line":"     *"},
{"lineNum":"  563","line":"     *    - If a is infinity, we detect this, and at the end of the"},
{"lineNum":"  564","line":"     *      computation replace the result (which will be meaningless,"},
{"lineNum":"  565","line":"     *      but we compute to be constant-time) with b.x : b.y : 1."},
{"lineNum":"  566","line":"     *"},
{"lineNum":"  567","line":"     *    - If a = -b, we have y1 = -y2, which is a degenerate case."},
{"lineNum":"  568","line":"     *      But here the answer is infinity, so we simply set the"},
{"lineNum":"  569","line":"     *      infinity flag of the result, overriding the computed values"},
{"lineNum":"  570","line":"     *      without even needing to cmov."},
{"lineNum":"  571","line":"     *"},
{"lineNum":"  572","line":"     *    - If y1 = -y2 but x1 != x2, which does occur thanks to certain"},
{"lineNum":"  573","line":"     *      properties of our curve (specifically, 1 has nontrivial cube"},
{"lineNum":"  574","line":"     *      roots in our field, and the curve equation has no x coefficient)"},
{"lineNum":"  575","line":"     *      then the answer is not infinity but also not given by the above"},
{"lineNum":"  576","line":"     *      equation. In this case, we cmov in place an alternate expression"},
{"lineNum":"  577","line":"     *      for lambda. Specifically (y1 - y2)/(x1 - x2). Where both these"},
{"lineNum":"  578","line":"     *      expressions for lambda are defined, they are equal, and can be"},
{"lineNum":"  579","line":"     *      obtained from each other by multiplication by (y1 + y2)/(y1 + y2)"},
{"lineNum":"  580","line":"     *      then substitution of x^3 + 7 for y^2 (using the curve equation)."},
{"lineNum":"  581","line":"     *      For all pairs of nonzero points (a, b) at least one is defined,"},
{"lineNum":"  582","line":"     *      so this covers everything."},
{"lineNum":"  583","line":"     */"},
{"lineNum":"  584","line":""},
{"lineNum":"  585","line":"    secp256k1_fe_sqr(&zz, &a->z);                       /* z = Z1^2 */","class":"lineCov","hits":"1","order":"4731","possible_hits":"1",},
{"lineNum":"  586","line":"    u1 = a->x; secp256k1_fe_normalize_weak(&u1);        /* u1 = U1 = X1*Z2^2 (1) */","class":"lineCov","hits":"1","order":"4732","possible_hits":"1",},
{"lineNum":"  587","line":"    secp256k1_fe_mul(&u2, &b->x, &zz);                  /* u2 = U2 = X2*Z1^2 (1) */","class":"lineCov","hits":"1","order":"4733","possible_hits":"1",},
{"lineNum":"  588","line":"    s1 = a->y; secp256k1_fe_normalize_weak(&s1);        /* s1 = S1 = Y1*Z2^3 (1) */","class":"lineCov","hits":"1","order":"4734","possible_hits":"1",},
{"lineNum":"  589","line":"    secp256k1_fe_mul(&s2, &b->y, &zz);                  /* s2 = Y2*Z1^2 (1) */","class":"lineCov","hits":"1","order":"4735","possible_hits":"1",},
{"lineNum":"  590","line":"    secp256k1_fe_mul(&s2, &s2, &a->z);                  /* s2 = S2 = Y2*Z1^3 (1) */","class":"lineCov","hits":"1","order":"4736","possible_hits":"1",},
{"lineNum":"  591","line":"    t = u1; secp256k1_fe_add(&t, &u2);                  /* t = T = U1+U2 (2) */","class":"lineCov","hits":"1","order":"4737","possible_hits":"1",},
{"lineNum":"  592","line":"    m = s1; secp256k1_fe_add(&m, &s2);                  /* m = M = S1+S2 (2) */","class":"lineCov","hits":"1","order":"4738","possible_hits":"1",},
{"lineNum":"  593","line":"    secp256k1_fe_sqr(&rr, &t);                          /* rr = T^2 (1) */","class":"lineCov","hits":"1","order":"4739","possible_hits":"1",},
{"lineNum":"  594","line":"    secp256k1_fe_negate(&m_alt, &u2, 1);                /* Malt = -X2*Z1^2 */","class":"lineCov","hits":"1","order":"4740","possible_hits":"1",},
{"lineNum":"  595","line":"    secp256k1_fe_mul(&tt, &u1, &m_alt);                 /* tt = -U1*U2 (2) */","class":"lineCov","hits":"1","order":"4741","possible_hits":"1",},
{"lineNum":"  596","line":"    secp256k1_fe_add(&rr, &tt);                         /* rr = R = T^2-U1*U2 (3) */","class":"lineCov","hits":"1","order":"4742","possible_hits":"1",},
{"lineNum":"  597","line":"    /** If lambda = R/M = 0/0 we have a problem (except in the \"trivial\""},
{"lineNum":"  598","line":"     *  case that Z = z1z2 = 0, and this is special-cased later on). */"},
{"lineNum":"  599","line":"    degenerate = secp256k1_fe_normalizes_to_zero(&m) &","class":"lineCov","hits":"2","order":"4743","possible_hits":"2",},
{"lineNum":"  600","line":"                 secp256k1_fe_normalizes_to_zero(&rr);","class":"lineCov","hits":"1","order":"4744","possible_hits":"1",},
{"lineNum":"  601","line":"    /* This only occurs when y1 == -y2 and x1^3 == x2^3, but x1 != x2."},
{"lineNum":"  602","line":"     * This means either x1 == beta*x2 or beta*x1 == x2, where beta is"},
{"lineNum":"  603","line":"     * a nontrivial cube root of one. In either case, an alternate"},
{"lineNum":"  604","line":"     * non-indeterminate expression for lambda is (y1 - y2)/(x1 - x2),"},
{"lineNum":"  605","line":"     * so we set R/M equal to this. */"},
{"lineNum":"  606","line":"    rr_alt = s1;","class":"lineCov","hits":"1","order":"4745","possible_hits":"1",},
{"lineNum":"  607","line":"    secp256k1_fe_mul_int(&rr_alt, 2);       /* rr = Y1*Z2^3 - Y2*Z1^3 (2) */","class":"lineCov","hits":"1","order":"4746","possible_hits":"1",},
{"lineNum":"  608","line":"    secp256k1_fe_add(&m_alt, &u1);          /* Malt = X1*Z2^2 - X2*Z1^2 */","class":"lineCov","hits":"1","order":"4747","possible_hits":"1",},
{"lineNum":"  609","line":""},
{"lineNum":"  610","line":"    secp256k1_fe_cmov(&rr_alt, &rr, !degenerate);","class":"lineCov","hits":"1","order":"4748","possible_hits":"1",},
{"lineNum":"  611","line":"    secp256k1_fe_cmov(&m_alt, &m, !degenerate);","class":"lineCov","hits":"1","order":"4758","possible_hits":"1",},
{"lineNum":"  612","line":"    /* Now Ralt / Malt = lambda and is guaranteed not to be 0/0."},
{"lineNum":"  613","line":"     * From here on out Ralt and Malt represent the numerator"},
{"lineNum":"  614","line":"     * and denominator of lambda; R and M represent the explicit"},
{"lineNum":"  615","line":"     * expressions x1^2 + x2^2 + x1x2 and y1 + y2. */"},
{"lineNum":"  616","line":"    secp256k1_fe_sqr(&n, &m_alt);                       /* n = Malt^2 (1) */","class":"lineCov","hits":"1","order":"4759","possible_hits":"1",},
{"lineNum":"  617","line":"    secp256k1_fe_mul(&q, &n, &t);                       /* q = Q = T*Malt^2 (1) */","class":"lineCov","hits":"1","order":"4760","possible_hits":"1",},
{"lineNum":"  618","line":"    /* These two lines use the observation that either M == Malt or M == 0,"},
{"lineNum":"  619","line":"     * so M^3 * Malt is either Malt^4 (which is computed by squaring), or"},
{"lineNum":"  620","line":"     * zero (which is \"computed\" by cmov). So the cost is one squaring"},
{"lineNum":"  621","line":"     * versus two multiplications. */"},
{"lineNum":"  622","line":"    secp256k1_fe_sqr(&n, &n);","class":"lineCov","hits":"1","order":"4761","possible_hits":"1",},
{"lineNum":"  623","line":"    secp256k1_fe_cmov(&n, &m, degenerate);              /* n = M^3 * Malt (2) */","class":"lineCov","hits":"1","order":"4762","possible_hits":"1",},
{"lineNum":"  624","line":"    secp256k1_fe_sqr(&t, &rr_alt);                      /* t = Ralt^2 (1) */","class":"lineCov","hits":"1","order":"4763","possible_hits":"1",},
{"lineNum":"  625","line":"    secp256k1_fe_mul(&r->z, &a->z, &m_alt);             /* r->z = Malt*Z (1) */","class":"lineCov","hits":"1","order":"4764","possible_hits":"1",},
{"lineNum":"  626","line":"    infinity = secp256k1_fe_normalizes_to_zero(&r->z) * (1 - a->infinity);","class":"lineCov","hits":"1","order":"4765","possible_hits":"1",},
{"lineNum":"  627","line":"    secp256k1_fe_mul_int(&r->z, 2);                     /* r->z = Z3 = 2*Malt*Z (2) */","class":"lineCov","hits":"1","order":"4766","possible_hits":"1",},
{"lineNum":"  628","line":"    secp256k1_fe_negate(&q, &q, 1);                     /* q = -Q (2) */","class":"lineCov","hits":"1","order":"4767","possible_hits":"1",},
{"lineNum":"  629","line":"    secp256k1_fe_add(&t, &q);                           /* t = Ralt^2-Q (3) */","class":"lineCov","hits":"1","order":"4768","possible_hits":"1",},
{"lineNum":"  630","line":"    secp256k1_fe_normalize_weak(&t);","class":"lineCov","hits":"1","order":"4769","possible_hits":"1",},
{"lineNum":"  631","line":"    r->x = t;                                           /* r->x = Ralt^2-Q (1) */","class":"lineCov","hits":"1","order":"4770","possible_hits":"1",},
{"lineNum":"  632","line":"    secp256k1_fe_mul_int(&t, 2);                        /* t = 2*x3 (2) */","class":"lineCov","hits":"1","order":"4771","possible_hits":"1",},
{"lineNum":"  633","line":"    secp256k1_fe_add(&t, &q);                           /* t = 2*x3 - Q: (4) */","class":"lineCov","hits":"1","order":"4772","possible_hits":"1",},
{"lineNum":"  634","line":"    secp256k1_fe_mul(&t, &t, &rr_alt);                  /* t = Ralt*(2*x3 - Q) (1) */","class":"lineCov","hits":"1","order":"4773","possible_hits":"1",},
{"lineNum":"  635","line":"    secp256k1_fe_add(&t, &n);                           /* t = Ralt*(2*x3 - Q) + M^3*Malt (3) */","class":"lineCov","hits":"1","order":"4774","possible_hits":"1",},
{"lineNum":"  636","line":"    secp256k1_fe_negate(&r->y, &t, 3);                  /* r->y = Ralt*(Q - 2x3) - M^3*Malt (4) */","class":"lineCov","hits":"1","order":"4775","possible_hits":"1",},
{"lineNum":"  637","line":"    secp256k1_fe_normalize_weak(&r->y);","class":"lineCov","hits":"1","order":"4776","possible_hits":"1",},
{"lineNum":"  638","line":"    secp256k1_fe_mul_int(&r->x, 4);                     /* r->x = X3 = 4*(Ralt^2-Q) */","class":"lineCov","hits":"1","order":"4777","possible_hits":"1",},
{"lineNum":"  639","line":"    secp256k1_fe_mul_int(&r->y, 4);                     /* r->y = Y3 = 4*Ralt*(Q - 2x3) - 4*M^3*Malt (4) */","class":"lineCov","hits":"1","order":"4778","possible_hits":"1",},
{"lineNum":"  640","line":""},
{"lineNum":"  641","line":"    /** In case a->infinity == 1, replace r with (b->x, b->y, 1). */"},
{"lineNum":"  642","line":"    secp256k1_fe_cmov(&r->x, &b->x, a->infinity);","class":"lineCov","hits":"1","order":"4779","possible_hits":"1",},
{"lineNum":"  643","line":"    secp256k1_fe_cmov(&r->y, &b->y, a->infinity);","class":"lineCov","hits":"1","order":"4780","possible_hits":"1",},
{"lineNum":"  644","line":"    secp256k1_fe_cmov(&r->z, &fe_1, a->infinity);","class":"lineCov","hits":"1","order":"4781","possible_hits":"1",},
{"lineNum":"  645","line":"    r->infinity = infinity;","class":"lineCov","hits":"1","order":"4782","possible_hits":"1",},
{"lineNum":"  646","line":"}","class":"linePartCov","hits":"1","order":"4783","possible_hits":"2",},
{"lineNum":"  647","line":""},
{"lineNum":"  648","line":"static void secp256k1_gej_rescale(secp256k1_gej *r, const secp256k1_fe *s) {","class":"lineCov","hits":"1","order":"4646","possible_hits":"1",},
{"lineNum":"  649","line":"    /* Operations: 4 mul, 1 sqr */"},
{"lineNum":"  650","line":"    secp256k1_fe zz;"},
{"lineNum":"  651","line":"    VERIFY_CHECK(!secp256k1_fe_is_zero(s));","class":"lineCov","hits":"1","order":"4647","possible_hits":"1",},
{"lineNum":"  652","line":"    secp256k1_fe_sqr(&zz, s);","class":"lineCov","hits":"1","order":"4648","possible_hits":"1",},
{"lineNum":"  653","line":"    secp256k1_fe_mul(&r->x, &r->x, &zz);                /* r->x *= s^2 */","class":"lineCov","hits":"1","order":"4649","possible_hits":"1",},
{"lineNum":"  654","line":"    secp256k1_fe_mul(&r->y, &r->y, &zz);","class":"lineCov","hits":"1","order":"4650","possible_hits":"1",},
{"lineNum":"  655","line":"    secp256k1_fe_mul(&r->y, &r->y, s);                  /* r->y *= s^3 */","class":"lineCov","hits":"1","order":"4651","possible_hits":"1",},
{"lineNum":"  656","line":"    secp256k1_fe_mul(&r->z, &r->z, s);                  /* r->z *= s   */","class":"lineCov","hits":"1","order":"4652","possible_hits":"1",},
{"lineNum":"  657","line":"}","class":"linePartCov","hits":"1","order":"4653","possible_hits":"2",},
{"lineNum":"  658","line":""},
{"lineNum":"  659","line":"static void secp256k1_ge_to_storage(secp256k1_ge_storage *r, const secp256k1_ge *a) {","class":"lineCov","hits":"1","order":"2614","possible_hits":"1",},
{"lineNum":"  660","line":"    secp256k1_fe x, y;"},
{"lineNum":"  661","line":"    VERIFY_CHECK(!a->infinity);"},
{"lineNum":"  662","line":"    x = a->x;","class":"lineCov","hits":"1","order":"2615","possible_hits":"1",},
{"lineNum":"  663","line":"    secp256k1_fe_normalize(&x);","class":"lineCov","hits":"1","order":"2616","possible_hits":"1",},
{"lineNum":"  664","line":"    y = a->y;","class":"lineCov","hits":"1","order":"2635","possible_hits":"1",},
{"lineNum":"  665","line":"    secp256k1_fe_normalize(&y);","class":"lineCov","hits":"1","order":"2636","possible_hits":"1",},
{"lineNum":"  666","line":"    secp256k1_fe_to_storage(&r->x, &x);","class":"lineCov","hits":"1","order":"2637","possible_hits":"1",},
{"lineNum":"  667","line":"    secp256k1_fe_to_storage(&r->y, &y);","class":"lineCov","hits":"1","order":"2644","possible_hits":"1",},
{"lineNum":"  668","line":"}","class":"linePartCov","hits":"1","order":"2645","possible_hits":"2",},
{"lineNum":"  669","line":""},
{"lineNum":"  670","line":"static void secp256k1_ge_from_storage(secp256k1_ge *r, const secp256k1_ge_storage *a) {","class":"lineCov","hits":"1","order":"4716","possible_hits":"1",},
{"lineNum":"  671","line":"    secp256k1_fe_from_storage(&r->x, &a->x);","class":"lineCov","hits":"1","order":"4717","possible_hits":"1",},
{"lineNum":"  672","line":"    secp256k1_fe_from_storage(&r->y, &a->y);","class":"lineCov","hits":"1","order":"4725","possible_hits":"1",},
{"lineNum":"  673","line":"    r->infinity = 0;","class":"lineCov","hits":"1","order":"4726","possible_hits":"1",},
{"lineNum":"  674","line":"}","class":"linePartCov","hits":"1","order":"4727","possible_hits":"2",},
{"lineNum":"  675","line":""},
{"lineNum":"  676","line":"static SECP256K1_INLINE void secp256k1_ge_storage_cmov(secp256k1_ge_storage *r, const secp256k1_ge_storage *a, int flag) {","class":"lineCov","hits":"1","order":"4703","possible_hits":"1",},
{"lineNum":"  677","line":"    secp256k1_fe_storage_cmov(&r->x, &a->x, flag);","class":"lineCov","hits":"1","order":"4704","possible_hits":"1",},
{"lineNum":"  678","line":"    secp256k1_fe_storage_cmov(&r->y, &a->y, flag);","class":"lineCov","hits":"1","order":"4713","possible_hits":"1",},
{"lineNum":"  679","line":"}","class":"linePartCov","hits":"1","order":"4714","possible_hits":"2",},
{"lineNum":"  680","line":""},
{"lineNum":"  681","line":"#ifdef USE_ENDOMORPHISM"},
{"lineNum":"  682","line":"static void secp256k1_ge_mul_lambda(secp256k1_ge *r, const secp256k1_ge *a) {","class":"lineCov","hits":"1","order":"5754","possible_hits":"1",},
{"lineNum":"  683","line":"    static const secp256k1_fe beta = SECP256K1_FE_CONST("},
{"lineNum":"  684","line":"        0x7ae96a2bul, 0x657c0710ul, 0x6e64479eul, 0xac3434e9ul,"},
{"lineNum":"  685","line":"        0x9cf04975ul, 0x12f58995ul, 0xc1396c28ul, 0x719501eeul"},
{"lineNum":"  686","line":"    );"},
{"lineNum":"  687","line":"    *r = *a;","class":"lineCov","hits":"1","order":"5755","possible_hits":"1",},
{"lineNum":"  688","line":"    secp256k1_fe_mul(&r->x, &r->x, &beta);","class":"lineCov","hits":"1","order":"5756","possible_hits":"1",},
{"lineNum":"  689","line":"}","class":"linePartCov","hits":"1","order":"5757","possible_hits":"2",},
{"lineNum":"  690","line":"#endif"},
{"lineNum":"  691","line":""},
{"lineNum":"  692","line":"static int secp256k1_gej_has_quad_y_var(const secp256k1_gej *a) {"},
{"lineNum":"  693","line":"    secp256k1_fe yz;"},
{"lineNum":"  694","line":""},
{"lineNum":"  695","line":"    if (a->infinity) {"},
{"lineNum":"  696","line":"        return 0;"},
{"lineNum":"  697","line":"    }"},
{"lineNum":"  698","line":""},
{"lineNum":"  699","line":"    /* We rely on the fact that the Jacobi symbol of 1 / a->z^3 is the same as"},
{"lineNum":"  700","line":"     * that of a->z. Thus a->y / a->z^3 is a quadratic residue iff a->y * a->z"},
{"lineNum":"  701","line":"       is */"},
{"lineNum":"  702","line":"    secp256k1_fe_mul(&yz, &a->y, &a->z);"},
{"lineNum":"  703","line":"    return secp256k1_fe_is_quad_var(&yz);"},
{"lineNum":"  704","line":"}"},
{"lineNum":"  705","line":""},
{"lineNum":"  706","line":"#endif /* SECP256K1_GROUP_IMPL_H */"},
]};
var percent_low = 25;var percent_high = 75;
var header = { "command" : "lightning_invoice-19f07d0577b73f6d", "date" : "2019-06-01 07:50:27", "instrumented" : 365, "covered" : 315,};
var merged_data = [];
